<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CHILAB + MAXCNC | Art, Design & Fabrication</title>
    <!-- Set flag before loading any scripts -->
    <script>window.THREE_ALREADY_IMPORTED = true;</script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.globe.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow-x: hidden;
            font-family: 'Roboto', sans-serif;
            background-color: #101014;
            color: #f1f1f3;
            padding-top: 0 !important;
            margin-top: 0 !important;
        }
        
        .studio-font {
            font-family: 'Montserrat', sans-serif;
        }
        
        .hero-section {
            height: 100vh;
            position: relative;
            padding-top: 80px; /* Adjusted to account for fixed navbar */
        }
        
        .particle-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .gradient-text {
            background: linear-gradient(90deg, #65CCF3, #FFFFFF, #65CCF3);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .gradient-border {
            position: relative;
        }
        
        .gradient-border::before {
            content: '';
            position: absolute;
            inset: -2px;
            z-index: -1;
            background: linear-gradient(90deg, #65CCF3, #FFFFFF, #65CCF3);
            border-radius: inherit;
            padding: 2px;
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
        }
        
        .floating {
            animation: floating 8s ease-in-out infinite;
        }
        
        .floating-2 {
            animation: floating 6s ease-in-out infinite 2s;
        }
        
        .floating-3 {
            animation: floating 7s ease-in-out infinite 1s;
        }
        
        @keyframes floating {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(5deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }
        
        .material-card {
            background: linear-gradient(135deg, rgba(101, 204, 243, 0.1) 0%, rgba(255, 255, 255, 0.1) 50%, rgba(101, 204, 243, 0.1) 100%);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .chicago-glow {
            text-shadow: 0 0 10px rgba(101, 204, 243, 0.7);
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(101, 204, 243, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(101, 204, 243, 0); }
            100% { box-shadow: 0 0 0 0 rgba(101, 204, 243, 0); }
        }
        
        .rotate-x {
            animation: rotate-x 20s infinite linear;
            transform-style: preserve-3d;
        }
        
        @keyframes rotate-x {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
        }
        
        .material-display {
            perspective: 1000px;
        }
        
        .display-surface {
            background: linear-gradient(45deg, rgba(101, 204, 243, 0.2), rgba(255, 255, 255, 0.4));
            box-shadow: inset 0 0 50px rgba(101, 204, 243, 0.5);
            border-radius: 50%;
            filter: blur(0.5px);
        }
        
        .nav-link {
            position: relative;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(90deg, #65CCF3, #FFFFFF, #65CCF3);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem !important;
                line-height: 1.2 !important;
            }
            
            h2 {
                font-size: 2rem !important;
            }
            
            .hero-section {
                padding-top: 80px;
                height: auto;
                min-height: 100vh;
            }
            
            .material-card {
                padding: 1rem !important;
            }
            
            .display-3d-mobile {
                height: 250px !important;
                margin-top: 2rem;
                margin-bottom: 2rem;
            }
            
            .button-text-mobile {
                font-size: 0.875rem !important;
                padding: 0.5rem 1rem !important;
            }
            
            .mobile-grid-1 {
                grid-template-columns: 1fr !important;
            }
            
            .mobile-mt-6 {
                margin-top: 1.5rem !important;
            }
            
            .mobile-py-12 {
                padding-top: 3rem !important;
                padding-bottom: 3rem !important;
            }
            
            .mobile-hidden {
                display: none !important;
            }
            
            .mobile-pt-4 {
                padding-top: 1rem !important;
            }
            
            .mobile-text-sm {
                font-size: 0.875rem !important;
            }
            
            .mobile-px-4 {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }
        }
        
        .scroll-down {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0) translateX(-50%);
            }
            40% {
                transform: translateY(-20px) translateX(-50%);
            }
            60% {
                transform: translateY(-10px) translateX(-50%);
            }
        }
        
        .feature-panel {
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.6s ease-out;
        }
        
        .feature-panel.visible {
            transform: translateY(0);
            opacity: 1;
        }
        
        .material-effect {
            position: relative;
        }
        
        .material-effect::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 50%;
            background: linear-gradient(to bottom, rgba(101, 204, 243, 0.3), transparent);
            transform: perspective(500px) rotateX(60deg) scaleY(0.8);
            filter: blur(15px);
            z-index: -1;
        }
        
        .scanline {
            position: relative;
            overflow: hidden;
        }
        
        .scanline::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 0%,
                rgba(101, 204, 243, 0.03) 50%,
                transparent 100%
            );
            animation: scanline 5s linear infinite;
            pointer-events: none;
        }
        
        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }
        
        /* Floating 3D Shapes */
        .floating-cube {
            animation: floating 8s ease-in-out infinite, rotate-x 20s infinite linear;
            transform-style: preserve-3d;
        }
        
        .floating-pyramid {
            animation: floating 7s ease-in-out infinite 1s, rotate-y 25s infinite linear reverse;
            transform-style: preserve-3d;
        }
        
        .floating-torus {
            animation: floating 9s ease-in-out infinite 2s, rotate-x 30s infinite linear reverse;
            transform-style: preserve-3d;
        }
        
        @keyframes rotate-y {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }
        
        .noise::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            z-index: -1;
        }
        
        /* Touch optimizations for mobile */
        .touch-target {
            min-height: 44px;
            min-width: 44px;
        }
        
        /* Fix content that might overflow on small screens */
        .overflow-wrap-anywhere {
            overflow-wrap: anywhere;
            word-break: break-word;
        }
        
        /* Better spacing on mobile */
        @media (max-width: 768px) {
            .section-mobile {
                padding: 3rem 1rem !important;
            }
            
            .gap-mobile-4 {
                gap: 1rem !important;
            }
            
            .text-mobile-base {
                font-size: 1rem !important;
                line-height: 1.5 !important;
            }
            
            .card-mobile {
                margin-bottom: 1.5rem !important;
            }
            
            /* Better form inputs on mobile */
            input, textarea, select {
                font-size: 16px !important; /* Prevents iOS zoom on focus */
            }
        }
        
        /* Fix for top margin issue */
        html, body {
            margin: 0;
            padding: 0;
        }
        
        .nav-fixed {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

/* Mobile fixes */
@media (max-width: 768px) {
  .nav-fixed { position: relative !important; }
  .view-portfolio-btn { font-size: 0.875rem !important; padding: 0.5rem 1rem !important; }
}

    </style>
</head>
<body class="pt-0 mt-0">
    <!-- Background Animation -->
    <div id="vanta-bg" class="particle-bg"></div>
    
    <!-- Navigation with Mobile Menu -->
    <nav class="nav-fixed bg-black bg-opacity-60 backdrop-filter backdrop-blur-lg border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                <div class="flex-shrink-0 flex items-center">
                    <span class="text-2xl font-bold gradient-text studio-font">CHILAB + MAXCNC</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-center space-x-8">
                        <a href="#" class="nav-link px-3 py-2 text-sm font-medium">Home</a>
                        <a href="#services" class="nav-link px-3 py-2 text-sm font-medium">Services</a>
                        <a href="#projects" class="nav-link px-3 py-2 text-sm font-medium">Projects</a>
                        <a href="#about" class="nav-link px-3 py-2 text-sm font-medium">About</a>
                        <a href="#contact" class="nav-link px-3 py-2 text-sm font-medium">Contact</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="view-portfolio-btn relative overflow-hidden group bg-transparent border-2 border-blue-400 hover:border-white text-white px-6 py-2 rounded-full font-medium transition-all duration-500 hidden md:block">
                        <span class="relative z-10">View Portfolio</span>
                        <span class="absolute inset-0 bg-gradient-to-r from-blue-500 to-blue-600 opacity-0 group-hover:opacity-100 transition-all duration-500"></span>
                    </button>
                    <!-- Mobile menu button -->
                    <button id="mobileMenuButton" class="md:hidden inline-flex items-center justify-center p-2 rounded-md text-white hover:text-blue-400 focus:outline-none">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile menu, show/hide based on menu state -->
        <div id="mobileMenu" class="md:hidden hidden px-2 pt-2 pb-3 space-y-1 bg-black bg-opacity-90 backdrop-filter backdrop-blur-lg">
            <a href="#" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white border-b border-gray-800">Home</a>
            <a href="#services" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white border-b border-gray-800">Services</a>
            <a href="#projects" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white border-b border-gray-800">Projects</a>
            <a href="#about" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white border-b border-gray-800">About</a>
            <a href="#contact" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white">Contact</a>
        </div>
    </nav>
    
    <!-- Hero Section with Material Display -->
    <section class="hero-section flex items-center justify-center relative overflow-hidden px-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="text-center lg:text-left">
                <div class="relative inline-block mb-8">
                    <div class="absolute -inset-1 bg-gradient-to-r from-white to-white rounded-xl blur opacity-75"></div>
                    <span class="relative px-4 py-2 bg-black rounded-lg text-sm font-medium studio-font">
                        ART • DESIGN • FABRICATION
                    </span>
                </div>
                <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight studio-font">
                    <span class="gradient-text">Crafting</span> Vision Into Reality
                </h1>
                <p class="text-xl text-gray-300 max-w-2xl mb-10 mobile-text-sm">
                    CHILAB + MAXCNC blends traditional craftsmanship with innovative technology to create bespoke art installations and architectural elements that transcend conventional boundaries.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                    <button class="view-portfolio-btn relative overflow-hidden group px-8 py-4 rounded-full font-medium text-lg bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 button-text-mobile">
                        <span class="relative z-10">Explore Projects</span>
                        <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-all duration-500"></span>
                    </button>
                    <button class="px-8 py-4 rounded-full font-medium text-lg border-2 border-blue-400 hover:border-white text-white hover:text-blue-200 transition-all duration-300 transform hover:scale-105 button-text-mobile">
                        <i class="fas fa-play mr-2"></i> View Process
                    </button>
                </div>
            </div>
            
            <!-- Material Display -->
            <div class="relative flex items-center justify-center h-96 lg:h-auto display-3d-mobile">
                <div class="absolute w-64 h-64 md:w-80 md:h-80 lg:w-96 lg:h-96">
                    <div class="floating-torus h-full w-full">
                        <!-- Three.js will render here -->
                        <canvas id="bronzeTorusCanvas" class="h-full w-full"></canvas>
                    </div>
                </div>
                
                <div class="material-card h-64 w-64 md:h-80 md:w-80 lg:h-96 lg:w-96 rounded-full opacity-90 relative">
                    <div class="absolute inset-0 flex items-center justify-center">
                        <div class="display-surface h-3/4 w-3/4 flex items-center justify-center">
                            <div class="text-center p-6">
                                <h3 class="text-2xl font-bold mb-2 gradient-text studio-font">CHILAB + MAXCNC</h3>
                                <p class="text-xs text-gray-300">EST. 2013 • CHICAGO</p>
                                <div class="mt-4 h-1 w-16 mx-auto bg-gradient-to-r from-blue-400 to-white"></div>
                            </div>
                        </div>
                    </div>
                    <div class="absolute -bottom-4 left-1/2 transform -translate-x-1/2 w-1/2 h-2 bg-blue-400 rounded-full blur-md opacity-60"></div>
                </div>
                
                <!-- Floating 3D Shapes -->
                <div class="absolute -left-10 top-1/4 w-16 h-16 mobile-hidden">
                    <div class="floating-cube h-full w-full">
                        <canvas id="materialCubeCanvas" class="h-full w-full"></canvas>
                    </div>
                </div>
                
                <div class="absolute -right-10 bottom-1/3 w-20 h-20 mobile-hidden">
                    <div class="floating-pyramid h-full w-full">
                        <canvas id="materialPyramidCanvas" class="h-full w-full"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Scroll Down Indicator -->
            <div class="scroll-down lg:hidden">
                <a href="#services" class="text-blue-400 hover:text-blue-600 transition-colors duration-300">
                    <i class="fas fa-chevron-down text-2xl"></i>
                </a>
            </div>
        </div>
    </section>
    
    <!-- Services Section -->
    <section id="services" class="py-20 relative overflow-hidden px-4 section-mobile">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-5xl font-bold mb-4 studio-font">
                    <span class="gradient-text">Material</span> Expertise
                </h2>
                <p class="text-xl text-gray-300 max-w-4xl mx-auto">
                    We combine time-honored techniques with cutting-edge technology to transform raw materials into extraordinary experiences.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mobile-grid-1">
                <!-- Service 1 -->
                <div class="feature-panel material-card p-8 rounded-2xl transition-all duration-700 hover:transform hover:scale-105 card-mobile">
                    <div class="relative">
                        <div class="absolute -left-2 -top-2 w-12 h-12 bg-blue-500 rounded-full opacity-20 blur-sm"></div>
                        <div class="relative flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-hammer text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold gradient-text studio-font">Metal</h3>
                        </div>
                    </div>
                    <p class="text-gray-300 mt-6 mb-6">
                        Expert craftsmanship in bronze, aluminum, and steel, from intricate patination to large-scale architectural elements.
                    </p>
                    <div class="relative h-40 mt-6 rounded-xl overflow-hidden">
                        <canvas id="metalCanvas" class="w-full h-full bg-black/30"></canvas>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-20 h-20 border-2 border-blue-400/50 rounded-full animate-ping opacity-30"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Service 2 -->
                <div class="feature-panel material-card p-8 rounded-2xl transition-all duration-700 delay-100 hover:transform hover:scale-105 card-mobile">
                    <div class="relative">
                        <div class="absolute -left-2 -top-2 w-12 h-12 bg-blue-600 rounded-full opacity-20 blur-sm"></div>
                        <div class="relative flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-tree text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold gradient-text studio-font">Wood</h3>
                        </div>
                    </div>
                    <p class="text-gray-300 mt-6 mb-6">
                        Custom woodworking with precision CNC milling, hand finishing and traditional joinery techniques for elegant results.
                    </p>
                    <div class="relative h-40 mt-6 rounded-xl overflow-hidden">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-16 h-16 bg-gradient-to-br from-blue-600 to-blue-700 rounded-full flex items-center justify-center pulse">
                                <i class="fas fa-leaf text-2xl"></i>
                            </div>
                        </div>
                        <div class="absolute inset-0">
                            <div class="grid grid-cols-5 grid-rows-5 h-full w-full">
                                <!-- Grid for woodgrain effect -->
                                <?php for($i=0; $i<25; $i++): ?>
                                <div class="border border-gray-700 relative">
                                    <div class="absolute inset-0 bg-blue-500/10 animate-pulse" style="animation-delay: <?= $i*0.1 ?>s; opacity: 0;"></div>
                                </div>
                                <?php endfor; ?>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Service 3 -->
                <div class="feature-panel material-card p-8 rounded-2xl transition-all duration-700 delay-200 hover:transform hover:scale-105 card-mobile">
                    <div class="relative">
                        <div class="absolute -left-2 -top-2 w-12 h-12 bg-blue-700 rounded-full opacity-20 blur-sm"></div>
                        <div class="relative flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-700 to-blue-800 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-vector-square text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold gradient-text studio-font">Plastics</h3>
                        </div>
                    </div>
                    <p class="text-gray-300 mt-6 mb-6">
                        Advanced polymer fabrication with thermal forming, precision cutting, and modern finishing for functional and artistic applications.
                    </p>
                    <div class="relative h-40 mt-6 rounded-xl overflow-hidden">
                        <div class="absolute inset-0">
                            <div class="grid grid-cols-6 gap-1 h-full w-full p-1">
                                <!-- Material blocks animation -->
                                <?php for($i=0; $i<36; $i++): ?>
                                <div class="bg-gray-800/50 border border-gray-700 rounded-sm animate-pulse" style="animation-delay: <?= $i*0.05 ?>s;"></div>
                                <?php endfor; ?>
                            </div>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-16 h-16 rotate-x">
                                <div class="w-full h-full bg-gradient-to-br from-blue-700 to-white flex items-center justify-center">
                                    <i class="fas fa-cube text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Service 4 -->
                <div class="feature-panel material-card p-8 rounded-2xl transition-all duration-700 delay-300 hover:transform hover:scale-105 card-mobile">
                    <div class="relative">
                        <div class="absolute -left-2 -top-2 w-12 h-12 bg-blue-400 rounded-full opacity-20 blur-sm"></div>
                        <div class="relative flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-layer-group text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold gradient-text studio-font">Composites</h3>
                        </div>
                    </div>
                    <p class="text-gray-300 mt-6 mb-6">
                        Innovative composite material work combining carbon fiber, fiberglass, and resins for high-performance, lightweight components.
                    </p>
                    <div class="relative h-40 mt-6 rounded-xl overflow-hidden">
                        <div class="absolute inset-0">
                            <div class="grid grid-cols-6 gap-1 h-full w-full p-1">
                                <!-- Layered effect animation -->
                                <?php for($i=0; $i<36; $i++): ?>
                                <div class="bg-gray-800/50 border border-gray-700 rounded-sm animate-pulse" style="animation-delay: <?= $i*0.05 ?>s;"></div>
                                <?php endfor; ?>
                            </div>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-16 h-16 rotate-x">
                                <div class="w-full h-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center">
                                    <i class="fas fa-cubes text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Projects Showcase Section -->
    <section id="projects" class="py-20 relative overflow-hidden px-4 section-mobile">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-5xl font-bold mb-4 studio-font">
                    <span class="gradient-text">Featured</span> Projects
                </h2>
                <p class="text-xl text-gray-300 max-w-4xl mx-auto">
                    Our portfolio of innovative projects that merge art, design, and fabrication in meaningful ways.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mobile-grid-1">
                <!-- Project 1 - Uber -->
                <div class="feature-panel material-card rounded-2xl overflow-hidden transition-all duration-700 delay-75 hover:transform hover:scale-105 card-mobile">
                    <div class="relative h-64">
                        <canvas id="uberCanvas" class="absolute inset-0 w-full h-full bg-gray-900"></canvas>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-6">
                            <h3 class="text-2xl font-bold mb-1">Uber Headquarters</h3>
                            <span class="text-sm text-blue-400">Architectural Installation</span>
                        </div>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 mb-4">Grand spiral staircase and parametric feature wall for Uber's Chicago headquarters in the historic Old Post Office.</p>
                        <button class="text-blue-400 font-medium flex items-center group">
                            <span>View Project</span>
                            <i class="fas fa-arrow-right ml-2 group-hover:ml-3 transition-all duration-300"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Project 2 - St. Nicholas -->
                <div class="feature-panel material-card rounded-2xl overflow-hidden transition-all duration-700 delay-150 hover:transform hover:scale-105 card-mobile">
                    <div class="relative h-64">
                        <canvas id="stNicholasCanvas" class="absolute inset-0 w-full h-full bg-gray-900"></canvas>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-6">
                            <h3 class="text-2xl font-bold mb-1">St. Nicholas Church</h3>
                            <span class="text-sm text-blue-400">Sacred Glasswork</span>
                        </div>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 mb-4">Custom glass crosses and bronze fixtures for the Santiago Calatrava-designed Greek Orthodox Church at the World Trade Center.</p>
                        <button class="text-blue-400 font-medium flex items-center group">
                            <span>View Project</span>
                            <i class="fas fa-arrow-right ml-2 group-hover:ml-3 transition-all duration-300"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Project 3 - Knoll -->
                <div class="feature-panel material-card rounded-2xl overflow-hidden transition-all duration-700 delay-300 hover:transform hover:scale-105 card-mobile">
                    <div class="relative h-64">
                        <canvas id="knollCanvas" class="absolute inset-0 w-full h-full bg-gray-900"></canvas>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-6">
                            <h3 class="text-2xl font-bold mb-1">Knoll Showroom</h3>
                            <span class="text-sm text-blue-400">Bronze Installation</span>
                        </div>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 mb-4">Architectural sculpture and 24-foot solid bronze recreation of the iconic Antenna Table for Knoll's Chicago showroom.</p>
                        <button class="text-blue-400 font-medium flex items-center group">
                            <span>View Project</span>
                            <i class="fas fa-arrow-right ml-2 group-hover:ml-3 transition-all duration-300"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-12">
                <button class="relative overflow-hidden group px-8 py-4 rounded-full font-medium text-lg bg-transparent border-2 border-blue-400 hover:border-white text-white transition-all duration-300 transform hover:scale-105">
                    <span class="relative z-10">View All Projects</span>
                    <span class="absolute inset-0 bg-gradient-to-r from-blue-500 to-blue-600 opacity-0 group-hover:opacity-100 transition-all duration-500"></span>
                </button>
            </div>
            
            <!-- Material Technology Visualization -->
            <div class="mt-20 relative h-96 rounded-3xl overflow-hidden material-effect scanline noise">
                <canvas id="materialVizCanvas" class="absolute inset-0 w-full h-full"></canvas>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="text-center p-8 max-w-2xl">
                        <h3 class="text-3xl md:text-4xl font-bold mb-4 gradient-text studio-font">Material Expertise</h3>
                        <p class="text-gray-300 mb-6">Blending traditional craftsmanship with innovative technologies to create extraordinary objects and experiences.</p>
                        <div class="flex justify-center gap-4">
                            <button class="px-6 py-2 rounded-full text-sm font-medium bg-blue-500/20 border border-blue-400/50 hover:bg-blue-500/30">Metal</button>
                            <button class="px-6 py-2 rounded-full text-sm font-medium bg-blue-600/20 border border-blue-500/50 hover:bg-blue-600/30">Wood</button>
                            <button class="px-6 py-2 rounded-full text-sm font-medium bg-blue-700/20 border border-blue-600/50 hover:bg-blue-700/30">Plastics</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Performance Stats -->
    <section id="about" class="py-20 relative overflow-hidden px-4 section-mobile">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="material-card rounded-3xl p-8 md:p-12 grid grid-cols-1 md:grid-cols-2 gap-12 items-center mobile-grid-1">
                <div>
                    <h2 class="text-3xl md:text-5xl font-bold mb-6 studio-font">
                        <span class="gradient-text">Studio</span> Highlights
                    </h2>
                    <p class="text-xl text-gray-300 mb-8">
                        Founded in 2013 by Ben Stagl and Ally Reza, CHILAB + MAXCNC has established itself as a leader in custom fabrication and design.
                    </p>
                    <div class="grid grid-cols-2 gap-6">
                        <div>
                            <div class="text-4xl font-bold gradient-text mb-2 studio-font">2013</div>
                            <p class="text-gray-400">Founded in Chicago</p>
                        </div>
                        <div>
                            <div class="text-4xl font-bold gradient-text mb-2 studio-font">100+</div>
                            <p class="text-gray-400">Completed Projects</p>
                        </div>
                        <div>
                            <div class="text-4xl font-bold gradient-text mb-2 studio-font">4.9/5</div>
                            <p class="text-gray-400">Client Satisfaction</p>
                        </div>
                        <div>
                            <div class="text-4xl font-bold gradient-text mb-2 studio-font">12+</div>
                            <p class="text-gray-400">Featured Publications</p>
                        </div>
                    </div>
                </div>
                
                <div class="h-64 md:h-96 relative">
                    <canvas id="studioCanvas" class="absolute inset-0 w-full h-full"></canvas>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Quote Section -->
    <section class="py-20 relative overflow-hidden px-4 bg-black bg-opacity-50 section-mobile">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="text-5xl text-blue-400 mb-6">
                <i class="fas fa-quote-left"></i>
            </div>
            <blockquote class="text-2xl md:text-3xl font-light italic text-gray-200 mb-8">
                "I feel like there is a special energy that is put into the pieces that we create because we really love and care about making things that last lifetimes."
            </blockquote>
            <div class="font-medium text-xl text-blue-400">— Ally Reza, Co-founder</div>
        </div>
    </section>
    
    <!-- Contact Section -->
    <section id="contact" class="py-20 relative overflow-hidden px-4 section-mobile">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-5xl font-bold mb-4 studio-font">
                    <span class="gradient-text">Let's</span> Collaborate
                </h2>
                <p class="text-xl text-gray-300 max-w-4xl mx-auto">
                    Reach out to discuss how we can bring your vision to life through expert craftsmanship and innovative design.
                </p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 mobile-grid-1">
                <div class="material-card rounded-3xl p-8 md:p-12 relative overflow-hidden">
                    <form class="space-y-6 relative z-10">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-300 mb-2">Your Name</label>
                            <input type="text" id="name" class="w-full px-5 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your name">
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-300 mb-2">Email Address</label>
                            <input type="email" id="email" class="w-full px-5 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="your@email.com">
                        </div>
                        <div>
                            <label for="project" class="block text-sm font-medium text-gray-300 mb-2">Project Type</label>
                            <select id="project" class="w-full px-5 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option>Select project type</option>
                                <option>Architectural Installation</option>
                                <option>Fine Art Fabrication</option>
                                <option>Custom Furniture</option>
                                <option>Public Art</option>
                            </select>
                        </div>
                        <div>
                            <label for="message" class="block text-sm font-medium text-gray-300 mb-2">Project Details</label>
                            <textarea id="message" rows="4" class="w-full px-5 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Tell us about your project..."></textarea>
                        </div>
                        <button type="submit" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-8 py-4 rounded-xl font-medium text-lg transition-all duration-300 transform hover:scale-105">
                            Send Message
                        </button>
                    </form>
                    <div class="absolute -bottom-20 -right-20 w-64 h-64 bg-blue-500/10 rounded-full blur-3xl"></div>
                    <div class="absolute -top-20 -left-20 w-64 h-64 bg-blue-700/10 rounded-full blur-3xl"></div>
                </div>
                
                <div class="relative">
                    <div class="h-full w-full rounded-3xl overflow-hidden">
                        <canvas id="contactCanvas" class="h-full w-full bg-gray-900"></canvas>
                    </div>
                    <div class="absolute bottom-8 left-8 right-8 p-6 bg-black/70 backdrop-filter backdrop-blur-sm rounded-xl border border-gray-700">
                        <h3 class="text-xl font-bold mb-2 gradient-text studio-font">Visit Our Studio</h3>
                        <p class="text-gray-300 mb-4">We're located in the vibrant art and design community of Chicago.</p>
                        <div class="flex space-x-4">
                            <a href="#" class="w-10 h-10 bg-gray-800 hover:bg-blue-400 rounded-full flex items-center justify-center transition-all duration-300">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="#" class="w-10 h-10 bg-gray-800 hover:bg-blue-400 rounded-full flex items-center justify-center transition-all duration-300">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                            <a href="#" class="w-10 h-10 bg-gray-800 hover:bg-blue-400 rounded-full flex items-center justify-center transition-all duration-300">
                                <i class="fab fa-behance"></i>
                            </a>
                            <a href="#" class="w-10 h-10 bg-gray-800 hover:bg-blue-400 rounded-full flex items-center justify-center transition-all duration-300">
                                <i class="fas fa-envelope"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer class="py-12 border-t border-gray-800 relative overflow-hidden px-4 mobile-py-12 mobile-px-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mobile-grid-1 gap-mobile-4">
                <div>
                    <h4 class="text-xl font-bold gradient-text studio-font mb-4">CHILAB + MAXCNC</h4>
                    <p class="text-gray-400 mb-6">Blending artisanal craftsmanship with innovative technology to create extraordinary objects and experiences since 2013.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">
                            <i class="fab fa-behance"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h5 class="text-lg font-bold text-white mb-4">Services</h5>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Metal Fabrication</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Wood Fabrication</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Plastics</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Composites</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Public Art</a></li>
                    </ul>
                </div>
                <div>
                    <h5 class="text-lg font-bold text-white mb-4">Studio</h5>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Team</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Process</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">News</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-blue-400 transition-colors duration-300">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h5 class="text-lg font-bold text-white mb-4">Newsletter</h5>
                    <p class="text-gray-400 mb-4">Subscribe to our newsletter for updates on our latest projects and exhibitions.</p>
                    <form class="flex">
                        <input type="email" placeholder="Your email" class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-l-lg focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent w-full">
                        <button type="submit" class="px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-r-lg transition-all duration-300">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-500 text-sm mb-4 md:mb-0">© 2025 CHILAB + MAXCNC. All rights reserved.</p>
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-500 hover:text-blue-400 text-sm transition-colors duration-300">Privacy Policy</a>
                    <a href="#" class="text-gray-500 hover:text-blue-400 text-sm transition-colors duration-300">Terms of Service</a>
                    <a href="#" class="text-gray-500 hover:text-blue-400 text-sm transition-colors duration-300">Cookies</a>
                </div>
            </div>
        </div>
        
        <!-- Floating 3D Material -->
        <div class="absolute -bottom-20 -right-20 w-40 h-40 mobile-hidden">
            <canvas id="footerMaterialCanvas" class="w-full h-full"></canvas>
        </div>
    </footer>
    
    <script>
        // Ensure THREE flag is set early
        if (window.THREE_ALREADY_IMPORTED !== true) {
            window.THREE_ALREADY_IMPORTED = true;
        }
        
        // Device detection - simple approach without ES6
        var isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;
        
        // Initialize Vanta.js background if available
        document.addEventListener('DOMContentLoaded', function() {
            // Apply appropriate styles based on device
            if (isMobile) {
                document.body.classList.add('mobile-device');
                
                // Smaller background effect for mobile
                if (typeof VANTA !== 'undefined' && VANTA.GLOBE) {
                    VANTA.GLOBE({
                        el: "#vanta-bg",
                        mouseControls: true,
                        touchControls: true,
                        gyroControls: true,
                        minHeight: 200.00,
                        minWidth: 200.00,
                        scale: 0.75,
                        scaleMobile: 0.5,
                        color: 0x65CCF3,
                        backgroundColor: 0x101014,
                        size: 0.6,
                        points: 8.00,
                        maxDistance: 18.00,
                        spacing: 10.00
                    });
                } else {
                    // Fallback if VANTA is not available
                    var particleBg = document.getElementById('vanta-bg');
                    if (particleBg) {
                        particleBg.style.background = 'linear-gradient(135deg, #101014 0%, #1a1a24 100%)';
                    }
                    console.log('VANTA.js not available, using fallback background.');
                }
            } else {
                // Desktop settings
                if (typeof VANTA !== 'undefined' && VANTA.GLOBE) {
                    VANTA.GLOBE({
                        el: "#vanta-bg",
                        mouseControls: true,
                        touchControls: true,
                        gyroControls: false,
                        minHeight: 200.00,
                        minWidth: 200.00,
                        scale: 1.00,
                        scaleMobile: 0.75,
                        color: 0x65CCF3,
                        backgroundColor: 0x101014,
                        size: 0.8
                    });
                } else {
                    // Fallback if VANTA is not available
                    var particleBg = document.getElementById('vanta-bg');
                    if (particleBg) {
                        particleBg.style.background = 'linear-gradient(135deg, #101014 0%, #1a1a24 100%)';
                    }
                    console.log('VANTA.js not available, using fallback background.');
                }
            }
            
            // Mobile menu toggle
            var mobileMenuButton = document.getElementById('mobileMenuButton');
            var mobileMenu = document.getElementById('mobileMenu');
            
            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', function() {
                    if (mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.remove('hidden');
                    } else {
                        mobileMenu.classList.add('hidden');
                    }
                });
                
                // Close mobile menu when clicking on a link
                var mobileLinks = mobileMenu.querySelectorAll('a');
                for (var i = 0; i < mobileLinks.length; i++) {
                    mobileLinks[i].addEventListener('click', function() {
                        mobileMenu.classList.add('hidden');
                    });
                }
            }
            
            // Initialize Three.js 3D models with error handling
            try {
                // Check if THREE is available
                if (typeof THREE === 'undefined') {
                    console.log('THREE.js not available, using fallback for 3D elements.');
                    // Create fallback backgrounds for all canvas elements
                    document.querySelectorAll('canvas').forEach(canvas => {
                        const ctx = canvas.getContext('2d');
                        if (ctx) {
                            // Create gradient background
                            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                            gradient.addColorStop(0, '#1a1a24');
                            gradient.addColorStop(1, '#101014');
                            ctx.fillStyle = gradient;
                            ctx.fillRect(0, 0, canvas.width, canvas.height);
                            
                            // Add some subtle texture/pattern
                            ctx.fillStyle = 'rgba(101, 204, 243, 0.1)';
                            for (let i = 0; i < 20; i++) {
                                const x = Math.random() * canvas.width;
                                const y = Math.random() * canvas.height;
                                const size = Math.random() * 10 + 2;
                                ctx.beginPath();
                                ctx.arc(x, y, size, 0, Math.PI * 2);
                                ctx.fill();
                            }
                        }
                    });
                    return; // Exit early if THREE.js isn't available
                }
                
                // Bronze Torus in Hero Section
                const bronzeTorusCanvas = document.getElementById('bronzeTorusCanvas');
                if (!bronzeTorusCanvas) throw new Error('Bronze torus canvas not found');
                
                const bronzeTorusScene = new THREE.Scene();
                const bronzeTorusCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const bronzeTorusRenderer = new THREE.WebGLRenderer({ 
                    canvas: bronzeTorusCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const bronzeTorusGeometry = new THREE.TorusGeometry(1, 0.4, 16, 100);
                const bronzeTorusMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0xE12726, // Red from Chicago flag
                    wireframe: true,
                    transparent: true,
                    opacity: 0.8
                });
                const bronzeTorus = new THREE.Mesh(bronzeTorusGeometry, bronzeTorusMaterial);
                bronzeTorusScene.add(bronzeTorus);
                
                bronzeTorusCamera.position.z = 3;
                
                // Material Cube in Hero Section
                const materialCubeCanvas = document.getElementById('materialCubeCanvas');
                if (!materialCubeCanvas) throw new Error('Material cube canvas not found');
                
                const materialCubeScene = new THREE.Scene();
                const materialCubeCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const materialCubeRenderer = new THREE.WebGLRenderer({ 
                    canvas: materialCubeCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const materialCubeGeometry = new THREE.BoxGeometry(1, 1, 1);
                const materialCubeMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0xE12726,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.6
                });
                const materialCube = new THREE.Mesh(materialCubeGeometry, materialCubeMaterial);
                materialCubeScene.add(materialCube);
                
                materialCubeCamera.position.z = 3;
                
                // Material Pyramid in Hero Section
                const materialPyramidCanvas = document.getElementById('materialPyramidCanvas');
                if (!materialPyramidCanvas) throw new Error('Material pyramid canvas not found');
                
                const materialPyramidScene = new THREE.Scene();
                const materialPyramidCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const materialPyramidRenderer = new THREE.WebGLRenderer({ 
                    canvas: materialPyramidCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const materialPyramidGeometry = new THREE.ConeGeometry(0.8, 1.5, 4);
                const materialPyramidMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0xE12726,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.6
                });
                const materialPyramid = new THREE.Mesh(materialPyramidGeometry, materialPyramidMaterial);
                materialPyramid.rotation.y = Math.PI / 4;
                materialPyramidScene.add(materialPyramid);
                
                materialPyramidCamera.position.z = 3;
                
                // Metal Canvas in Services
                const metalCanvas = document.getElementById('metalCanvas');
                if (!metalCanvas) throw new Error('Metal canvas not found');
                
                const metalScene = new THREE.Scene();
                const metalCamera = new THREE.PerspectiveCamera(75, 2, 0.1, 1000);
                const metalRenderer = new THREE.WebGLRenderer({ 
                    canvas: metalCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                var metalPointsGeometry = new THREE.BufferGeometry();
                var metalVertices = [];
                for (var i = 0; i < 1000; i++) {
                    metalVertices.push(
                        Math.random() * 2 - 1,
                        Math.random() * 2 - 1,
                        Math.random() * 2 - 1
                    );
                }
                metalPointsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(metalVertices, 3));
                const metalPointsMaterial = new THREE.PointsMaterial({
                    color: 0x65CCF3,
                    size: 0.02,
                    transparent: true,
                    opacity: 0.8
                });
                const metalPoints = new THREE.Points(metalPointsGeometry, metalPointsMaterial);
                metalScene.add(metalPoints);
                
                metalCamera.position.z = 2;
                if (metalCanvas.width && metalCanvas.height) {
                    metalRenderer.setSize(metalCanvas.width, metalCanvas.height);
                }
                
                // Uber Project Canvas
                const uberCanvas = document.getElementById('uberCanvas');
                if (!uberCanvas) throw new Error('Uber canvas not found');
                
                const uberScene = new THREE.Scene();
                const uberCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const uberRenderer = new THREE.WebGLRenderer({ 
                    canvas: uberCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                // Create a parametric wall for Uber project
                var uberGeometry = new THREE.BufferGeometry();
                var uberVertices = [];
                var gridSize = 10;
                
                for (var i = 0; i < gridSize; i++) {
                    for (var j = 0; j < gridSize; j++) {
                        uberVertices.push(
                            (i - gridSize/2) * 0.1,
                            (j - gridSize/2) * 0.1,
                            Math.sin(i * j * 0.1) * 0.05
                        );
                    }
                }
                
                uberGeometry.setAttribute('position', new THREE.Float32BufferAttribute(uberVertices, 3));
                const uberMaterial = new THREE.PointsMaterial({
                    color: 0x65CCF3,
                    size: 0.05,
                    sizeAttenuation: true
                });
                const uberPoints = new THREE.Points(uberGeometry, uberMaterial);
                uberScene.add(uberPoints);
                
                uberCamera.position.z = 2;
                if (uberCanvas.width && uberCanvas.height) {
                    uberRenderer.setSize(uberCanvas.width, uberCanvas.height);
                }
                
                // St. Nicholas Project Canvas
                const stNicholasCanvas = document.getElementById('stNicholasCanvas');
                if (!stNicholasCanvas) throw new Error('St. Nicholas canvas not found');
                
                const stNicholasScene = new THREE.Scene();
                const stNicholasCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const stNicholasRenderer = new THREE.WebGLRenderer({ 
                    canvas: stNicholasCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                // Create glass crosses for St. Nicholas
                var crossGroup = new THREE.Group();
                
                for (var i = 0; i < 10; i++) {
                    var verticalGeometry = new THREE.BoxGeometry(0.05, 0.3, 0.05);
                    var horizontalGeometry = new THREE.BoxGeometry(0.2, 0.05, 0.05);
                    var glassMaterial = new THREE.MeshBasicMaterial({
                        color: 0xE12726,
                        transparent: true,
                        opacity: 0.3
                    });
                    
                    var verticalPart = new THREE.Mesh(verticalGeometry, glassMaterial);
                    var horizontalPart = new THREE.Mesh(horizontalGeometry, glassMaterial);
                    horizontalPart.position.y = 0.05;
                    
                    var cross = new THREE.Group();
                    cross.add(verticalPart);
                    cross.add(horizontalPart);
                    
                    cross.position.x = (Math.random() - 0.5) * 1.5;
                    cross.position.y = (Math.random() - 0.5) * 1.5;
                    cross.position.z = (Math.random() - 0.5) * 1.5;
                    cross.rotation.x = Math.random() * Math.PI;
                    cross.rotation.y = Math.random() * Math.PI;
                    
                    crossGroup.add(cross);
                }
                
                stNicholasScene.add(crossGroup);
                stNicholasCamera.position.z = 3;
                if (stNicholasCanvas.width && stNicholasCanvas.height) {
                    stNicholasRenderer.setSize(stNicholasCanvas.width, stNicholasCanvas.height);
                }
                
                // Knoll Canvas
                const knollCanvas = document.getElementById('knollCanvas');
                if (!knollCanvas) throw new Error('Knoll canvas not found');
                
                const knollScene = new THREE.Scene();
                const knollCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const knollRenderer = new THREE.WebGLRenderer({ 
                    canvas: knollCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                // Create a table for Knoll project
                const tableGroup = new THREE.Group();
                
                // Table top
                var tableTopGeometry = new THREE.BoxGeometry(1.5, 0.05, 0.8);
                var tableMaterial = new THREE.MeshBasicMaterial({
                    color: 0x65CCF3,
                    wireframe: false
                });
                var tableTop = new THREE.Mesh(tableTopGeometry, tableMaterial);
                tableTop.position.y = 0.4;
                tableGroup.add(tableTop);
                
                // Table legs
                for (var i = 0; i < 4; i++) {
                    var legGeometry = new THREE.CylinderGeometry(0.03, 0.03, 0.8, 8);
                    var leg = new THREE.Mesh(legGeometry, tableMaterial);
                    
                    var xPos = i < 2 ? -0.6 : 0.6;
                    var zPos = i % 2 === 0 ? -0.3 : 0.3;
                    
                    leg.position.set(xPos, 0, zPos);
                    tableGroup.add(leg);
                }
                
                knollScene.add(tableGroup);
                
                // Add some vertical metal rods behind (marquee)
                var rodsGroup = new THREE.Group();
                for (var i = 0; i < 15; i++) {
                    var rodGeometry = new THREE.CylinderGeometry(0.01, 0.01, 2, 8);
                    var rodMaterial = new THREE.MeshBasicMaterial({
                        color: 0xE12726,
                        wireframe: false
                    });
                    var rod = new THREE.Mesh(rodGeometry, rodMaterial);
                    
                    rod.position.z = -0.5;
                    rod.position.x = (i - 7) * 0.1;
                    rod.position.y = 0.5;
                    
                    rodsGroup.add(rod);
                }
                
                knollScene.add(rodsGroup);
                
                knollCamera.position.z = 3;
                if (knollCanvas.width && knollCanvas.height) {
                    knollRenderer.setSize(knollCanvas.width, knollCanvas.height);
                }
                
                // Material Viz Canvas
                const materialVizCanvas = document.getElementById('materialVizCanvas');
                if (!materialVizCanvas) throw new Error('Material viz canvas not found');
                
                const materialVizScene = new THREE.Scene();
                const materialVizCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const materialVizRenderer = new THREE.WebGLRenderer({ 
                    canvas: materialVizCanvas, 
                    alpha: true,
                    antialias: true 
                });
                if (materialVizCanvas.width && materialVizCanvas.height) {
                    materialVizRenderer.setSize(materialVizCanvas.width, materialVizCanvas.height);
                }
                
                // Create a material preview system
                var materialVizParticles = 500;
                var materialVizPositions = new Float32Array(materialVizParticles * 3);
                var materialVizColors = new Float32Array(materialVizParticles * 3);
                
                for (var i = 0; i < materialVizParticles; i++) {
                    materialVizPositions[i * 3] = (Math.random() - 0.5) * 10;
                    materialVizPositions[i * 3 + 1] = (Math.random() - 0.5) * 10;
                    materialVizPositions[i * 3 + 2] = (Math.random() - 0.5) * 10;
                    
                    // Chicago flag color palette - blues and whites with a touch of red
                    var colorChoice = Math.random();
                    if (colorChoice < 0.7) {
                        materialVizColors[i * 3] = 0.4; // R - blue tone
                        materialVizColors[i * 3 + 1] = 0.8; // G - blue tone
                        materialVizColors[i * 3 + 2] = 0.95; // B - blue tone
                    } else if (colorChoice < 0.9) {
                        materialVizColors[i * 3] = 1.0; // R - white
                        materialVizColors[i * 3 + 1] = 1.0; // G - white
                        materialVizColors[i * 3 + 2] = 1.0; // B - white
                    } else {
                        materialVizColors[i * 3] = 0.88; // R - red
                        materialVizColors[i * 3 + 1] = 0.15; // G - red
                        materialVizColors[i * 3 + 2] = 0.15; // B - red
                    }
                }
                
                const materialVizGeometry = new THREE.BufferGeometry();
                materialVizGeometry.setAttribute('position', new THREE.BufferAttribute(materialVizPositions, 3));
                materialVizGeometry.setAttribute('color', new THREE.BufferAttribute(materialVizColors, 3));
                
                const materialVizMaterial = new THREE.PointsMaterial({
                    size: 0.1,
                    vertexColors: true,
                    transparent: true,
                    opacity: 0.8,
                    sizeAttenuation: true
                });
                
                const materialVizParticleSystem = new THREE.Points(materialVizGeometry, materialVizMaterial);
                materialVizScene.add(materialVizParticleSystem);
                
                materialVizCamera.position.z = 5;
                
                // Studio Canvas
                const studioCanvas = document.getElementById('studioCanvas');
                if (!studioCanvas) throw new Error('Studio canvas not found');
                
                const studioScene = new THREE.Scene();
                const studioCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const studioRenderer = new THREE.WebGLRenderer({ 
                    canvas: studioCanvas, 
                    alpha: true,
                    antialias: true 
                });
                if (studioCanvas.width && studioCanvas.height) {
                    studioRenderer.setSize(studioCanvas.width, studioCanvas.height);
                }
                
                // Create a studio visualization with tools and materials
                const studioGroup = new THREE.Group();
                
                // Create some workshop tools - simplified anvil
                var anvilBaseGeometry = new THREE.BoxGeometry(0.5, 0.2, 0.3);
                var anvilTopGeometry = new THREE.BoxGeometry(0.7, 0.1, 0.25);
                var metalMaterial = new THREE.MeshBasicMaterial({ color: 0x777777 });
                
                var anvilBase = new THREE.Mesh(anvilBaseGeometry, metalMaterial);
                var anvilTop = new THREE.Mesh(anvilTopGeometry, metalMaterial);
                anvilTop.position.y = 0.15;
                
                const anvil = new THREE.Group();
                anvil.add(anvilBase);
                anvil.add(anvilTop);
                anvil.position.x = -0.5;
                anvil.position.y = -0.2;
                
                studioGroup.add(anvil);
                
                // Metal bars
                for (let i = 0; i < 3; i++) {
                    const barGeometry = new THREE.BoxGeometry(0.1, 0.8, 0.1);
                    const barMaterial = new THREE.MeshBasicMaterial({ color: 0x65CCF3 });
                    const bar = new THREE.Mesh(barGeometry, barMaterial);
                    bar.position.x = 0.5;
                    bar.position.y = -0.2 + i * 0.2;
                    bar.rotation.z = Math.PI * 0.1;
                    studioGroup.add(bar);
                }
                
                // Add some tools
                var hammerGeometry = new THREE.CylinderGeometry(0.05, 0.05, 0.3, 8);
                var hammerHeadGeometry = new THREE.BoxGeometry(0.15, 0.1, 0.08);
                var woodMaterial = new THREE.MeshBasicMaterial({ color: 0x8b4513 });
                
                var hammerHandle = new THREE.Mesh(hammerGeometry, woodMaterial);
                var hammerHead = new THREE.Mesh(hammerHeadGeometry, metalMaterial);
                
                hammerHandle.rotation.z = Math.PI * 0.25;
                hammerHead.rotation.z = Math.PI * 0.25;
                
                hammerHandle.position.x = 0;
                hammerHandle.position.y = 0.2;
                
                hammerHead.position.x = 0.1;
                hammerHead.position.y = 0.35;
                
                studioGroup.add(hammerHandle);
                studioGroup.add(hammerHead);
                
                studioScene.add(studioGroup);
                
                studioCamera.position.z = 3;
                studioCamera.position.y = 0.3;
                
                // Contact Canvas
                const contactCanvas = document.getElementById('contactCanvas');
                if (!contactCanvas) throw new Error('Contact canvas not found');
                
                const contactScene = new THREE.Scene();
                const contactCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const contactRenderer = new THREE.WebGLRenderer({ 
                    canvas: contactCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                // Create workshop environment with material samples
                var materialSamples = [];
                var materialPositions = [];
                var materialColors = [0x65CCF3, 0xFFFFFF, 0xE12726, 0x65CCF3, 0xFFFFFF];
                
                for (var i = 0; i < 5; i++) {
                    var sampleGeometry = new THREE.BoxGeometry(0.5, 0.1, 0.5);
                    var sampleMaterial = new THREE.MeshBasicMaterial({
                        color: materialColors[i],
                        transparent: i > 2,
                        opacity: i > 2 ? 0.7 : 1
                    });
                    var sample = new THREE.Mesh(sampleGeometry, sampleMaterial);
                    
                    sample.position.x = (Math.random() - 0.5) * 3;
                    sample.position.y = (Math.random() - 0.5) * 2;
                    sample.position.z = (Math.random() - 0.5) * 3;
                    sample.rotation.x = Math.random() * Math.PI;
                    sample.rotation.z = Math.random() * Math.PI;
                    
                    materialPositions.push(new THREE.Vector3(
                        sample.position.x,
                        sample.position.y,
                        sample.position.z
                    ));
                    
                    materialSamples.push(sample);
                    contactScene.add(sample);
                }
                
                // Add connecting lines
                const lineGeometry = new THREE.BufferGeometry();
                const lineVertices = [];
                
                for (let i = 0; i < materialPositions.length; i++) {
                    for (let j = i + 1; j < materialPositions.length; j++) {
                        lineVertices.push(
                            materialPositions[i].x, materialPositions[i].y, materialPositions[i].z,
                            materialPositions[j].x, materialPositions[j].y, materialPositions[j].z
                        );
                    }
                }
                
                lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute(lineVertices, 3));
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: 0x65CCF3,
                    transparent: true,
                    opacity: 0.3
                });
                const lines = new THREE.LineSegments(lineGeometry, lineMaterial);
                contactScene.add(lines);
                
                contactCamera.position.z = 6;
                if (contactCanvas.width && contactCanvas.height) {
                    contactRenderer.setSize(contactCanvas.width, contactCanvas.height);
                }
                
                // Footer Material
                const footerMaterialCanvas = document.getElementById('footerMaterialCanvas');
                if (!footerMaterialCanvas) throw new Error('Footer material canvas not found');
                
                const footerMaterialScene = new THREE.Scene();
                const footerMaterialCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const footerMaterialRenderer = new THREE.WebGLRenderer({ 
                    canvas: footerMaterialCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const footerMaterialGeometry = new THREE.SphereGeometry(1, 32, 32);
                const footerMaterialMaterial = new THREE.MeshBasicMaterial({
                    color: 0x65CCF3,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.4
                });
                const footerMaterial = new THREE.Mesh(footerMaterialGeometry, footerMaterialMaterial);
                footerMaterialScene.add(footerMaterial);
                
                footerMaterialCamera.position.z = 3;
                
                // Intersection Observer for animated elements
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                        }
                    });
                }, {
                    threshold: 0.1
                });
                
                document.querySelectorAll('.feature-panel').forEach(panel => {
                    observer.observe(panel);
                });
                
                // Mobile optimization for 3D rendering
                if (isMobile) {
                    // Reduce complexity for mobile devices
                    const particleReduction = 0.5; // 50% reduction
                    
                    if (metalPointsGeometry && metalVertices) {
                        const reducedMetalVertices = [];
                        for (let i = 0; i < metalVertices.length * particleReduction; i += 3) {
                            reducedMetalVertices.push(
                                metalVertices[i],
                                metalVertices[i + 1],
                                metalVertices[i + 2]
                            );
                        }
                        metalPointsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(reducedMetalVertices, 3));
                    }
                    
                    // Reduce animation frame rate on mobile
                    const mobileFrameRate = 30; // fps
                    const frameInterval = 1000 / mobileFrameRate;
                    let lastFrameTime = 0;
                    
                    // Override the animation loop for mobile
                    function mobileAnimate(currentTime) {
                        requestAnimationFrame(mobileAnimate);
                        
                        // Throttle frame rate on mobile
                        if (currentTime - lastFrameTime < frameInterval) return;
                        lastFrameTime = currentTime;
                        
                        try {
                            // Mobile-optimized animations
                            if (bronzeTorus && bronzeTorusRenderer && bronzeTorusScene && bronzeTorusCamera) {
                                bronzeTorus.rotation.x += 0.005; // Reduced speed
                                bronzeTorus.rotation.y += 0.005;
                                bronzeTorusRenderer.render(bronzeTorusScene, bronzeTorusCamera);
                            }
                            
                // Only render visible elements on mobile
                            var visibleSections = [];
                            var sections = document.querySelectorAll('section');
                            for (var j = 0; j < sections.length; j++) {
                                var rect = sections[j].getBoundingClientRect();
                                if (rect.top < window.innerHeight && rect.bottom > 0) {
                                    visibleSections.push(sections[j].id || 'hero');
                                }
                            }
                            
                            // Only render what's visible
                            if (visibleSections.includes('hero') || visibleSections.length === 0) {
                                if (bronzeTorus && bronzeTorusRenderer && bronzeTorusScene && bronzeTorusCamera) {
                                    bronzeTorusRenderer.render(bronzeTorusScene, bronzeTorusCamera);
                                }
                            }
                            
                            if (visibleSections.includes('services')) {
                                if (metalPoints && metalRenderer && metalScene && metalCamera) {
                                    metalRenderer.render(metalScene, metalCamera);
                                }
                            }
                            
                            if (visibleSections.includes('projects')) {
                                if (uberPoints && uberRenderer && uberScene && uberCamera) {
                                    uberRenderer.render(uberScene, uberCamera);
                                }
                                if (crossGroup && stNicholasRenderer && stNicholasScene && stNicholasCamera) {
                                    stNicholasRenderer.render(stNicholasScene, stNicholasCamera);
                                }
                                if (tableGroup && knollRenderer && knollScene && knollCamera) {
                                    knollRenderer.render(knollScene, knollCamera);
                                }
                            }
                        } catch (error) {
                            console.log('Error in mobile animation loop:', error);
                        }
                    }
                    
                    // Use mobile-optimized animation loop
                    mobileAnimate(0);
                    return; // Skip the standard animation loop
                }
                
                // Standard animation loop for desktop
                function animate() {
                    requestAnimationFrame(animate);
                    
                    try {
                        // Rotate bronze torus
                        if (bronzeTorus && bronzeTorusRenderer && bronzeTorusScene && bronzeTorusCamera) {
                            bronzeTorus.rotation.x += 0.01;
                            bronzeTorus.rotation.y += 0.01;
                            bronzeTorusRenderer.render(bronzeTorusScene, bronzeTorusCamera);
                        }
                        
                        // Rotate material cube (slower)
                        if (materialCube && materialCubeRenderer && materialCubeScene && materialCubeCamera) {
                            materialCube.rotation.x += 0.005;
                            materialCube.rotation.y += 0.005;
                            materialCubeRenderer.render(materialCubeScene, materialCubeCamera);
                        }
                        
                        // Rotate material pyramid (different axis)
                        if (materialPyramid && materialPyramidRenderer && materialPyramidScene && materialPyramidCamera) {
                            materialPyramid.rotation.x += 0.007;
                            materialPyramid.rotation.z += 0.007;
                            materialPyramidRenderer.render(materialPyramidScene, materialPyramidCamera);
                        }
                        
                        // Animate metal points
                        if (metalPoints && metalRenderer && metalScene && metalCamera) {
                            metalPoints.rotation.y += 0.005;
                            metalRenderer.render(metalScene, metalCamera);
                        }
                        
                        // Animate Uber points
                        if (uberPoints && uberRenderer && uberScene && uberCamera) {
                            uberPoints.rotation.y += 0.01;
                            const uberPositions = uberPoints.geometry.attributes.position;
                            for (let i = 2; i < uberPositions.count * 3; i += 3) {
                                uberPositions.array[i] = Math.sin(Date.now() * 0.001 + i) * 0.1;
                            }
                            uberPositions.needsUpdate = true;
                            uberRenderer.render(uberScene, uberCamera);
                        }
                        
                        // Animate St. Nicholas crosses
                        if (crossGroup && stNicholasRenderer && stNicholasScene && stNicholasCamera) {
                            crossGroup.rotation.y += 0.005;
                            stNicholasRenderer.render(stNicholasScene, stNicholasCamera);
                        }
                        
                        // Animate Knoll project
                        if (tableGroup && rodsGroup && knollRenderer && knollScene && knollCamera) {
                            tableGroup.rotation.y += 0.005;
                            rodsGroup.rotation.y += 0.003;
                            knollRenderer.render(knollScene, knollCamera);
                        }
                        
                        // Animate material viz particles
                        if (materialVizParticleSystem && materialVizRenderer && materialVizScene && materialVizCamera) {
                            materialVizParticleSystem.rotation.y += 0.003;
                            materialVizRenderer.render(materialVizScene, materialVizCamera);
                        }
                        
                        // Animate studio elements
                        if (studioGroup && studioRenderer && studioScene && studioCamera) {
                            studioGroup.rotation.y += 0.005;
                            studioRenderer.render(studioScene, studioCamera);
                        }
                        
                        // Animate contact samples
                        if (materialSamples && materialSamples.length && contactRenderer && contactScene && contactCamera) {
                            for (var i = 0; i < materialSamples.length; i++) {
                                var sample = materialSamples[i];
                                sample.position.y = Math.sin(Date.now() * 0.001 + i) * 0.2;
                                sample.rotation.x += 0.01;
                            }
                            contactRenderer.render(contactScene, contactCamera);
                        }
                        
                        // Rotate footer material
                        if (footerMaterial && footerMaterialRenderer && footerMaterialScene && footerMaterialCamera) {
                            footerMaterial.rotation.y += 0.01;
                            footerMaterialRenderer.render(footerMaterialScene, footerMaterialCamera);
                        }
                    } catch (error) {
                        console.log('Error in animation loop:', error);
                    }
                }
                
                animate();
                
                // Make sure Three.js responsively adjusts on orientation change for mobile
                window.addEventListener('orientationchange', function() {
                    // Short delay to allow browser to complete orientation change
                    setTimeout(function() {
                        window.dispatchEvent(new Event('resize'));
                    }, 200);
                });
                
                // Trigger initial resize
                window.dispatchEvent(new Event('resize'));
                
                // Handle window resize
                window.addEventListener('resize', function() {
                    try {
                        // Adjust canvas sizes and camera aspects
                        const canvases = [
                            { canvas: bronzeTorusCanvas, renderer: bronzeTorusRenderer, camera: bronzeTorusCamera },
                            { canvas: materialCubeCanvas, renderer: materialCubeRenderer, camera: materialCubeCamera },
                            { canvas: materialPyramidCanvas, renderer: materialPyramidRenderer, camera: materialPyramidCamera },
                            { canvas: metalCanvas, renderer: metalRenderer, camera: metalCamera },
                            { canvas: uberCanvas, renderer: uberRenderer, camera: uberCamera },
                            { canvas: stNicholasCanvas, renderer: stNicholasRenderer, camera: stNicholasCamera },
                            { canvas: knollCanvas, renderer: knollRenderer, camera: knollCamera },
                            { canvas: materialVizCanvas, renderer: materialVizRenderer, camera: materialVizCamera },
                            { canvas: studioCanvas, renderer: studioRenderer, camera: studioCamera },
                            { canvas: contactCanvas, renderer: contactRenderer, camera: contactCamera },
                            { canvas: footerMaterialCanvas, renderer: footerMaterialRenderer,            /* Touch optimizations for mobile */
            .touch-target {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Fix content that might overflow on small screens */
            .overflow-wrap-anywhere {
                overflow-wrap: anywhere;
                word-break: break-word;
            }
            
            /* Better spacing on mobile */
            @media (max-width: 768px) {
                .section-mobile {
                    padding: 3rem 1rem !important;
                }
                
                .gap-mobile-4 {
                    gap: 1rem !important;
                }
                
                .text-mobile-base {
                    font-size: 1rem !important;
                    line-height: 1.5 !important;
                }
                
                .card-mobile {
                    margin-bottom: 1.5rem !important;
                }
                
                /* Better form inputs on mobile */
                input, textarea, select {
                    font-size: 16px !important; /* Prevents iOS zoom on focus */
                }
            }<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ChiLab Studio | Art, Design & Fabrication</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.globe.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow-x: hidden;
            font-family: 'Roboto', sans-serif;
            background-color: #101014;
            color: #f1f1f3;
        }
        
        .studio-font {
            font-family: 'Montserrat', sans-serif;
        }
        
        .hero-section {
            height: 100vh;
            position: relative;
        }
        
        .particle-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .gradient-text {
            background: linear-gradient(90deg, #65CCF3, #FFFFFF, #65CCF3);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .gradient-border {
            position: relative;
        }
        
        .gradient-border::before {
            content: '';
            position: absolute;
            inset: -2px;
            z-index: -1;
            background: linear-gradient(90deg, #65CCF3, #FFFFFF, #65CCF3);
            border-radius: inherit;
            padding: 2px;
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
        }
        
        .floating {
            animation: floating 8s ease-in-out infinite;
        }
        
        .floating-2 {
            animation: floating 6s ease-in-out infinite 2s;
        }
        
        .floating-3 {
            animation: floating 7s ease-in-out infinite 1s;
        }
        
        @keyframes floating {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(5deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }
        
        .material-card {
            background: linear-gradient(135deg, rgba(101, 204, 243, 0.1) 0%, rgba(255, 255, 255, 0.1) 50%, rgba(101, 204, 243, 0.1) 100%);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .chicago-glow {
            text-shadow: 0 0 10px rgba(101, 204, 243, 0.7);
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(101, 204, 243, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(101, 204, 243, 0); }
            100% { box-shadow: 0 0 0 0 rgba(101, 204, 243, 0); }
        }
        
        .rotate-x {
            animation: rotate-x 20s infinite linear;
            transform-style: preserve-3d;
        }
        
        @keyframes rotate-x {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
        }
        
        .material-display {
            perspective: 1000px;
        }
        
        .display-surface {
            background: linear-gradient(45deg, rgba(201, 157, 102, 0.2), rgba(194, 138, 77, 0.4));
            box-shadow: inset 0 0 50px rgba(201, 157, 102, 0.5);
            border-radius: 50%;
            filter: blur(0.5px);
        }
        
        .nav-link {
            position: relative;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(90deg, #c99d66, #e8c496, #c28a4d);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .scroll-down {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0) translateX(-50%);
            }
            40% {
                transform: translateY(-20px) translateX(-50%);
            }
            60% {
                transform: translateY(-10px) translateX(-50%);
            }
        }
        
        .feature-panel {
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.6s ease-out;
        }
        
        .feature-panel.visible {
            transform: translateY(0);
            opacity: 1;
        }
        
        .material-effect {
            position: relative;
        }
        
        .material-effect::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 50%;
            background: linear-gradient(to bottom, rgba(201, 157, 102, 0.3), transparent);
            transform: perspective(500px) rotateX(60deg) scaleY(0.8);
            filter: blur(15px);
            z-index: -1;
        }
        
        .scanline {
            position: relative;
            overflow: hidden;
        }
        
        .scanline::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 0%,
                rgba(201, 157, 102, 0.03) 50%,
                transparent 100%
            );
            animation: scanline 5s linear infinite;
            pointer-events: none;
        }
        
        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }
        
        /* Floating 3D Shapes */
        .floating-cube {
            animation: floating 8s ease-in-out infinite, rotate-x 20s infinite linear;
            transform-style: preserve-3d;
        }
        
        .floating-pyramid {
            animation: floating 7s ease-in-out infinite 1s, rotate-y 25s infinite linear reverse;
            transform-style: preserve-3d;
        }
        
        .floating-torus {
            animation: floating 9s ease-in-out infinite 2s, rotate-x 30s infinite linear reverse;
            transform-style: preserve-3d;
        }
        
        @keyframes rotate-y {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }
        
        .noise::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            z-index: -1;
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div id="vanta-bg" class="particle-bg"></div>
    
    <!-- Navigation with Mobile Menu -->
    <nav class="fixed w-full z-50 bg-black bg-opacity-60 backdrop-filter backdrop-blur-lg border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                <div class="flex-shrink-0 flex items-center">
                    <span class="text-2xl font-bold gradient-text studio-font">CHILAB + MAXCNC</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-center space-x-8">
                        <a href="#" class="nav-link px-3 py-2 text-sm font-medium">Home</a>
                        <a href="#services" class="nav-link px-3 py-2 text-sm font-medium">Services</a>
                        <a href="#projects" class="nav-link px-3 py-2 text-sm font-medium">Projects</a>
                        <a href="#about" class="nav-link px-3 py-2 text-sm font-medium">About</a>
                        <a href="#contact" class="nav-link px-3 py-2 text-sm font-medium">Contact</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="relative overflow-hidden group bg-transparent border-2 border-blue-400 hover:border-white text-white px-6 py-2 rounded-full font-medium transition-all duration-500 hidden md:block">
                        <span class="relative z-10">View Portfolio</span>
                        <span class="absolute inset-0 bg-gradient-to-r from-blue-500 to-blue-600 opacity-0 group-hover:opacity-100 transition-all duration-500"></span>
                    </button>
                    <!-- Mobile menu button -->
                    <button id="mobileMenuButton" class="md:hidden inline-flex items-center justify-center p-2 rounded-md text-white hover:text-blue-400 focus:outline-none">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile menu, show/hide based on menu state -->
        <div id="mobileMenu" class="md:hidden hidden px-2 pt-2 pb-3 space-y-1 bg-black bg-opacity-90 backdrop-filter backdrop-blur-lg">
            <a href="#" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white border-b border-gray-800">Home</a>
            <a href="#services" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white border-b border-gray-800">Services</a>
            <a href="#projects" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white border-b border-gray-800">Projects</a>
            <a href="#about" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white border-b border-gray-800">About</a>
            <a href="#contact" class="block px-3 py-4 rounded-md text-base font-medium text-white hover:bg-blue-700 hover:text-white">Contact</a>
        </div>
    </nav>
    
    <!-- Hero Section with Material Display -->
    <section class="hero-section flex items-center justify-center relative overflow-hidden px-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="text-center lg:text-left">
                <div class="relative inline-block mb-8">
                    <div class="absolute -inset-1 bg-gradient-to-r from-white to-white rounded-xl blur opacity-75"></div>
                    <span class="relative px-4 py-2 bg-black rounded-lg text-sm font-medium studio-font">
                        ART • DESIGN • FABRICATION
                    </span>
                </div>
                <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight studio-font">
                    <span class="gradient-text">Crafting</span> Vision Into Reality
                </h1>
                <p class="text-xl text-gray-300 max-w-2xl mb-10">
                    ChiLab Studio blends traditional craftsmanship with innovative technology to create bespoke art installations and architectural elements that transcend conventional boundaries.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                    <button class="relative overflow-hidden group px-8 py-4 rounded-full font-medium text-lg bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105">
                        <span class="relative z-10">Explore Projects</span>
                        <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-all duration-500"></span>
                    </button>
                    <button class="px-8 py-4 rounded-full font-medium text-lg border-2 border-blue-400 hover:border-white text-white hover:text-blue-200 transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-play mr-2"></i> View Process
                    </button>
                </div>
            </div>
            
            <!-- Material Display -->
            <div class="relative flex items-center justify-center h-96 lg:h-auto">
                <div class="absolute w-64 h-64 md:w-80 md:h-80 lg:w-96 lg:h-96">
                    <div class="floating-torus h-full w-full">
                        <!-- Three.js will render here -->
                        <canvas id="bronzeTorusCanvas" class="h-full w-full"></canvas>
                    </div>
                </div>
                
                <div class="material-card h-64 w-64 md:h-80 md:w-80 lg:h-96 lg:w-96 rounded-full opacity-90 relative">
                    <div class="absolute inset-0 flex items-center justify-center">
                        <div class="display-surface h-3/4 w-3/4 flex items-center justify-center">
                            <div class="text-center p-6">
                <h3 class="text-2xl font-bold mb-2 gradient-text studio-font">CHILAB + MAXCNC</h3>
                                <p class="text-xs text-gray-300">EST. 2013 • CHICAGO</p>
                                <div class="mt-4 h-1 w-16 mx-auto bg-gradient-to-r from-blue-400 to-white"></div>
                            </div>
                        </div>
                    </div>
                    <div class="absolute -bottom-4 left-1/2 transform -translate-x-1/2 w-1/2 h-2 bg-amber-400 rounded-full blur-md opacity-60"></div>
                </div>
                
                <!-- Floating 3D Shapes -->
                <div class="absolute -left-10 top-1/4 w-16 h-16">
                    <div class="floating-cube h-full w-full">
                        <canvas id="materialCubeCanvas" class="h-full w-full"></canvas>
                    </div>
                </div>
                
                <div class="absolute -right-10 bottom-1/3 w-20 h-20">
                    <div class="floating-pyramid h-full w-full">
                        <canvas id="materialPyramidCanvas" class="h-full w-full"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Scroll Down Indicator -->
            <div class="scroll-down lg:hidden">
                <a href="#services" class="text-amber-400 hover:text-amber-600 transition-colors duration-300">
                    <i class="fas fa-chevron-down text-2xl"></i>
                </a>
            </div>
        </div>
    </section>
    
    <!-- Services Section -->
    <section id="services" class="py-20 relative overflow-hidden px-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-5xl font-bold mb-4 studio-font">
                    <span class="gradient-text">Material</span> Expertise
                </h2>
                <p class="text-xl text-gray-300 max-w-4xl mx-auto">
                    We combine time-honored techniques with cutting-edge technology to transform raw materials into extraordinary experiences.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mobile-grid-1">
                <!-- Service 1 -->
                <div class="feature-panel material-card p-8 rounded-2xl transition-all duration-700 hover:transform hover:scale-105">
                    <div class="relative">
                        <div class="absolute -left-2 -top-2 w-12 h-12 bg-blue-500 rounded-full opacity-20 blur-sm"></div>
                        <div class="relative flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-hammer text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold gradient-text studio-font">Metal</h3>
                        </div>
                    </div>
                    <p class="text-gray-300 mt-6 mb-6">
                        Expert craftsmanship in bronze, aluminum, and steel, from intricate patination to large-scale architectural elements.
                    </p>
                    <div class="relative h-40 mt-6 rounded-xl overflow-hidden">
                        <canvas id="metalCanvas" class="w-full h-full bg-black/30"></canvas>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-20 h-20 border-2 border-blue-400/50 rounded-full animate-ping opacity-30"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Service 2 -->
                <div class="feature-panel material-card p-8 rounded-2xl transition-all duration-700 delay-100 hover:transform hover:scale-105">
                    <div class="relative">
                        <div class="absolute -left-2 -top-2 w-12 h-12 bg-blue-600 rounded-full opacity-20 blur-sm"></div>
                        <div class="relative flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-tree text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold gradient-text studio-font">Wood</h3>
                        </div>
                    </div>
                    <p class="text-gray-300 mt-6 mb-6">
                        Custom woodworking with precision CNC milling, hand finishing and traditional joinery techniques for elegant results.
                    </p>
                    <div class="relative h-40 mt-6 rounded-xl overflow-hidden">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-16 h-16 bg-gradient-to-br from-blue-600 to-blue-700 rounded-full flex items-center justify-center pulse">
                                <i class="fas fa-leaf text-2xl"></i>
                            </div>
                        </div>
                        <div class="absolute inset-0">
                            <div class="grid grid-cols-5 grid-rows-5 h-full w-full">
                                <!-- Grid for woodgrain effect -->
                                <?php for($i=0; $i<25; $i++): ?>
                                <div class="border border-gray-700 relative">
                                    <div class="absolute inset-0 bg-blue-500/10 animate-pulse" style="animation-delay: <?= $i*0.1 ?>s; opacity: 0;"></div>
                                </div>
                                <?php endfor; ?>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Service 3 -->
                <div class="feature-panel material-card p-8 rounded-2xl transition-all duration-700 delay-200 hover:transform hover:scale-105">
                    <div class="relative">
                        <div class="absolute -left-2 -top-2 w-12 h-12 bg-blue-700 rounded-full opacity-20 blur-sm"></div>
                        <div class="relative flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-700 to-blue-800 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-vector-square text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold gradient-text studio-font">Plastics</h3>
                        </div>
                    </div>
                    <p class="text-gray-300 mt-6 mb-6">
                        Advanced polymer fabrication with thermal forming, precision cutting, and modern finishing for functional and artistic applications.
                    </p>
                    <div class="relative h-40 mt-6 rounded-xl overflow-hidden">
                        <div class="absolute inset-0">
                            <div class="grid grid-cols-6 gap-1 h-full w-full p-1">
                                <!-- Material blocks animation -->
                                <?php for($i=0; $i<36; $i++): ?>
                                <div class="bg-gray-800/50 border border-gray-700 rounded-sm animate-pulse" style="animation-delay: <?= $i*0.05 ?>s;"></div>
                                <?php endfor; ?>
                            </div>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-16 h-16 rotate-x">
                                <div class="w-full h-full bg-gradient-to-br from-blue-700 to-white flex items-center justify-center">
                                    <i class="fas fa-cube text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Service 4 -->
                <div class="feature-panel material-card p-8 rounded-2xl transition-all duration-700 delay-300 hover:transform hover:scale-105">
                    <div class="relative">
                        <div class="absolute -left-2 -top-2 w-12 h-12 bg-blue-400 rounded-full opacity-20 blur-sm"></div>
                        <div class="relative flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-layer-group text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold gradient-text studio-font">Composites</h3>
                        </div>
                    </div>
                    <p class="text-gray-300 mt-6 mb-6">
                        Innovative composite material work combining carbon fiber, fiberglass, and resins for high-performance, lightweight components.
                    </p>
                    <div class="relative h-40 mt-6 rounded-xl overflow-hidden">
                        <div class="absolute inset-0">
                            <div class="grid grid-cols-6 gap-1 h-full w-full p-1">
                                <!-- Layered effect animation -->
                                <?php for($i=0; $i<36; $i++): ?>
                                <div class="bg-gray-800/50 border border-gray-700 rounded-sm animate-pulse" style="animation-delay: <?= $i*0.05 ?>s;"></div>
                                <?php endfor; ?>
                            </div>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-16 h-16 rotate-x">
                                <div class="w-full h-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center">
                                    <i class="fas fa-cubes text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Projects Showcase Section -->
    <section id="projects" class="py-20 relative overflow-hidden px-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-5xl font-bold mb-4 studio-font">
                    <span class="gradient-text">Featured</span> Projects
                </h2>
                <p class="text-xl text-gray-300 max-w-4xl mx-auto">
                    Our portfolio of innovative projects that merge art, design, and fabrication in meaningful ways.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mobile-grid-1">
                <!-- Project 1 - Uber -->
                <div class="feature-panel material-card rounded-2xl overflow-hidden transition-all duration-700 delay-75 hover:transform hover:scale-105">
                    <div class="relative h-64">
                        <canvas id="uberCanvas" class="absolute inset-0 w-full h-full bg-gray-900"></canvas>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-6">
                            <h3 class="text-2xl font-bold mb-1">Uber Headquarters</h3>
                            <span class="text-sm text-blue-400">Architectural Installation</span>
                        </div>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 mb-4">Grand spiral staircase and parametric feature wall for Uber's Chicago headquarters in the historic Old Post Office.</p>
                        <button class="text-amber-400 font-medium flex items-center group">
                            <span>View Project</span>
                            <i class="fas fa-arrow-right ml-2 group-hover:ml-3 transition-all duration-300"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Project 2 - St. Nicholas -->
                <div class="feature-panel material-card rounded-2xl overflow-hidden transition-all duration-700 delay-150 hover:transform hover:scale-105">
                    <div class="relative h-64">
                        <canvas id="stNicholasCanvas" class="absolute inset-0 w-full h-full bg-gray-900"></canvas>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-6">
                            <h3 class="text-2xl font-bold mb-1">St. Nicholas Church</h3>
                            <span class="text-sm text-blue-400">Sacred Glasswork</span>
                        </div>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 mb-4">Custom glass crosses and bronze fixtures for the Santiago Calatrava-designed Greek Orthodox Church at the World Trade Center.</p>
                        <button class="text-amber-400 font-medium flex items-center group">
                            <span>View Project</span>
                            <i class="fas fa-arrow-right ml-2 group-hover:ml-3 transition-all duration-300"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Project 3 - Knoll -->
                <div class="feature-panel material-card rounded-2xl overflow-hidden transition-all duration-700 delay-300 hover:transform hover:scale-105">
                    <div class="relative h-64">
                        <canvas id="knollCanvas" class="absolute inset-0 w-full h-full bg-gray-900"></canvas>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-6">
                            <h3 class="text-2xl font-bold mb-1">Knoll Showroom</h3>
                            <span class="text-sm text-blue-400">Bronze Installation</span>
                        </div>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 mb-4">Architectural sculpture and 24-foot solid bronze recreation of the iconic Antenna Table for Knoll's Chicago showroom.</p>
                        <button class="text-amber-400 font-medium flex items-center group">
                            <span>View Project</span>
                            <i class="fas fa-arrow-right ml-2 group-hover:ml-3 transition-all duration-300"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-12">
                <button class="relative overflow-hidden group px-8 py-4 rounded-full font-medium text-lg bg-transparent border-2 border-blue-400 hover:border-white text-white transition-all duration-300 transform hover:scale-105">
                    <span class="relative z-10">View All Projects</span>
                    <span class="absolute inset-0 bg-gradient-to-r from-blue-500 to-blue-600 opacity-0 group-hover:opacity-100 transition-all duration-500"></span>
                </button>
            </div>
            
            <!-- Material Technology Visualization -->
            <div class="mt-20 relative h-96 rounded-3xl overflow-hidden material-effect scanline noise">
                <canvas id="materialVizCanvas" class="absolute inset-0 w-full h-full"></canvas>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="text-center p-8 max-w-2xl">
                        <h3 class="text-3xl md:text-4xl font-bold mb-4 gradient-text studio-font">Material Expertise</h3>
                        <p class="text-gray-300 mb-6">Blending traditional craftsmanship with innovative technologies to create extraordinary objects and experiences.</p>
                        <div class="flex justify-center gap-4">
                            <button class="px-6 py-2 rounded-full text-sm font-medium bg-blue-500/20 border border-blue-400/50 hover:bg-blue-500/30">Metal</button>
                            <button class="px-6 py-2 rounded-full text-sm font-medium bg-blue-600/20 border border-blue-500/50 hover:bg-blue-600/30">Wood</button>
                            <button class="px-6 py-2 rounded-full text-sm font-medium bg-blue-700/20 border border-blue-600/50 hover:bg-blue-700/30">Plastics</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Performance Stats -->
    <section id="about" class="py-20 relative overflow-hidden px-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="material-card rounded-3xl p-8 md:p-12 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <div>
                    <h2 class="text-3xl md:text-5xl font-bold mb-6 studio-font">
                        <span class="gradient-text">Studio</span> Highlights
                    </h2>
                    <p class="text-xl text-gray-300 mb-8">
                        Founded in 2013 by Ben Stagl and Ally Reza, ChiLab Studio has established itself as a leader in custom fabrication and design.
                    </p>
                    <div class="grid grid-cols-2 gap-6">
                        <div>
                            <div class="text-4xl font-bold gradient-text mb-2 studio-font">2013</div>
                            <p class="text-gray-400">Founded in Chicago</p>
                        </div>
                        <div>
                            <div class="text-4xl font-bold gradient-text mb-2 studio-font">100+</div>
                            <p class="text-gray-400">Completed Projects</p>
                        </div>
                        <div>
                            <div class="text-4xl font-bold gradient-text mb-2 studio-font">4.9/5</div>
                            <p class="text-gray-400">Client Satisfaction</p>
                        </div>
                        <div>
                            <div class="text-4xl font-bold gradient-text mb-2 studio-font">12+</div>
                            <p class="text-gray-400">Featured Publications</p>
                        </div>
                    </div>
                </div>
                
                <div class="h-64 md:h-96 relative">
                    <canvas id="studioCanvas" class="absolute inset-0 w-full h-full"></canvas>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Quote Section -->
    <section class="py-20 relative overflow-hidden px-4 bg-black bg-opacity-50">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="text-5xl text-amber-400 mb-6">
                <i class="fas fa-quote-left"></i>
            </div>
            <blockquote class="text-2xl md:text-3xl font-light italic text-gray-200 mb-8">
                "I feel like there is a special energy that is put into the pieces that we create because we really love and care about making things that last lifetimes."
            </blockquote>
            <div class="font-medium text-xl text-amber-400">— Ally Reza, Co-founder</div>
        </div>
    </section>
    
    <!-- Contact Section -->
    <section id="contact" class="py-20 relative overflow-hidden px-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-5xl font-bold mb-4 studio-font">
                    <span class="gradient-text">Let's</span> Collaborate
                </h2>
                <p class="text-xl text-gray-300 max-w-4xl mx-auto">
                    Reach out to discuss how we can bring your vision to life through expert craftsmanship and innovative design.
                </p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 mobile-grid-1">
                <div class="material-card rounded-3xl p-8 md:p-12 relative overflow-hidden">
                    <form class="space-y-6 relative z-10">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-300 mb-2">Your Name</label>
                            <input type="text" id="name" class="w-full px-5 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" placeholder="Enter your name">
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-300 mb-2">Email Address</label>
                            <input type="email" id="email" class="w-full px-5 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" placeholder="your@email.com">
                        </div>
                        <div>
                            <label for="project" class="block text-sm font-medium text-gray-300 mb-2">Project Type</label>
                            <select id="project" class="w-full px-5 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent">
                                <option>Select project type</option>
                                <option>Architectural Installation</option>
                                <option>Fine Art Fabrication</option>
                                <option>Custom Furniture</option>
                                <option>Public Art</option>
                            </select>
                        </div>
                        <div>
                            <label for="message" class="block text-sm font-medium text-gray-300 mb-2">Project Details</label>
                            <textarea id="message" rows="4" class="w-full px-5 py-3 bg-gray-900 border border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent" placeholder="Tell us about your project..."></textarea>
                        </div>
                        <button type="submit" class="w-full bg-gradient-to-r from-amber-500 to-amber-700 hover:from-amber-600 hover:to-amber-800 text-white px-8 py-4 rounded-xl font-medium text-lg transition-all duration-300 transform hover:scale-105">
                            Send Message
                        </button>
                    </form>
                    <div class="absolute -bottom-20 -right-20 w-64 h-64 bg-amber-500/10 rounded-full blur-3xl"></div>
                    <div class="absolute -top-20 -left-20 w-64 h-64 bg-amber-700/10 rounded-full blur-3xl"></div>
                </div>
                
                <div class="relative">
                    <div class="h-full w-full rounded-3xl overflow-hidden">
                        <canvas id="contactCanvas" class="h-full w-full bg-gray-900"></canvas>
                    </div>
                    <div class="absolute bottom-8 left-8 right-8 p-6 bg-black/70 backdrop-filter backdrop-blur-sm rounded-xl border border-gray-700">
                        <h3 class="text-xl font-bold mb-2 gradient-text studio-font">Visit Our Studio</h3>
                        <p class="text-gray-300 mb-4">We're located in the vibrant art and design community of Chicago.</p>
                        <div class="flex space-x-4">
                            <a href="#" class="w-10 h-10 bg-gray-800 hover:bg-amber-400 rounded-full flex items-center justify-center transition-all duration-300">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="#" class="w-10 h-10 bg-gray-800 hover:bg-amber-400 rounded-full flex items-center justify-center transition-all duration-300">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                            <a href="#" class="w-10 h-10 bg-gray-800 hover:bg-amber-400 rounded-full flex items-center justify-center transition-all duration-300">
                                <i class="fab fa-behance"></i>
                            </a>
                            <a href="#" class="w-10 h-10 bg-gray-800 hover:bg-amber-400 rounded-full flex items-center justify-center transition-all duration-300">
                                <i class="fas fa-envelope"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer class="py-12 border-t border-gray-800 relative overflow-hidden px-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12">
                <div>
                    <h4 class="text-xl font-bold gradient-text studio-font mb-4">CHILAB + MAXCNC</h4>
                    <p class="text-gray-400 mb-6">Blending artisanal craftsmanship with innovative technology to create extraordinary objects and experiences since 2013.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">
                            <i class="fab fa-behance"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h5 class="text-lg font-bold text-white mb-4">Services</h5>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">Metal Fabrication</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">Glass Casting</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">Custom Furniture</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">Architectural Elements</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">Public Art</a></li>
                    </ul>
                </div>
                <div>
                    <h5 class="text-lg font-bold text-white mb-4">Studio</h5>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">Team</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">Process</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">News</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-amber-400 transition-colors duration-300">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h5 class="text-lg font-bold text-white mb-4">Newsletter</h5>
                    <p class="text-gray-400 mb-4">Subscribe to our newsletter for updates on our latest projects and exhibitions.</p>
                    <form class="flex">
                        <input type="email" placeholder="Your email" class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-l-lg focus:outline-none focus:ring-1 focus:ring-amber-500 focus:border-transparent w-full">
                        <button type="submit" class="px-4 py-2 bg-gradient-to-r from-amber-500 to-amber-700 hover:from-amber-600 hover:to-amber-800 text-white rounded-r-lg transition-all duration-300">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-500 text-sm mb-4 md:mb-0">© 2025 ChiLab Studio LLC. All rights reserved.</p>
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-500 hover:text-amber-400 text-sm transition-colors duration-300">Privacy Policy</a>
                    <a href="#" class="text-gray-500 hover:text-amber-400 text-sm transition-colors duration-300">Terms of Service</a>
                    <a href="#" class="text-gray-500 hover:text-amber-400 text-sm transition-colors duration-300">Cookies</a>
                </div>
            </div>
        </div>
        
        <!-- Floating 3D Material -->
        <div class="absolute -bottom-20 -right-20 w-40 h-40">
            <canvas id="footerMaterialCanvas" class="w-full h-full"></canvas>
        </div>
    </footer>
    
    <script>
        // Initialize Vanta.js background if available
        document.addEventListener('DOMContentLoaded', function() {
                            if (typeof VANTA !== 'undefined' && VANTA.GLOBE) {
                VANTA.GLOBE({
                    el: "#vanta-bg",
                    mouseControls: true,
                    touchControls: true,
                    gyroControls: false,
                    minHeight: 200.00,
                    minWidth: 200.00,
                    scale: 1.00,
                    scaleMobile: 1.00,
                    color: 0x65CCF3,
                    backgroundColor: 0x101014,
                    size: 0.8
                });
            } else {
                // Fallback if VANTA is not available
                const particleBg = document.getElementById('vanta-bg');
                if (particleBg) {
                    particleBg.style.background = 'linear-gradient(135deg, #101014 0%, #1a1a24 100%)';
                }
                console.log('VANTA.js not available, using fallback background.');
            }
        });
        
        // Initialize Three.js 3D models with error handling
        document.addEventListener('DOMContentLoaded', function() {
            // Check if THREE is available
            if (typeof THREE === 'undefined') {
                console.log('THREE.js not available, using fallback for 3D elements.');
                // Create fallback backgrounds for all canvas elements
                document.querySelectorAll('canvas').forEach(canvas => {
                    const ctx = canvas.getContext('2d');
                    if (ctx) {
                        // Create gradient background
                        const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                        gradient.addColorStop(0, '#1a1a24');
                        gradient.addColorStop(1, '#101014');
                        ctx.fillStyle = gradient;
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        
                        // Add some subtle texture/pattern
                        ctx.fillStyle = 'rgba(201, 157, 102, 0.1)';
                        for (let i = 0; i < 20; i++) {
                            const x = Math.random() * canvas.width;
                            const y = Math.random() * canvas.height;
                            const size = Math.random() * 10 + 2;
                            ctx.beginPath();
                            ctx.arc(x, y, size, 0, Math.PI * 2);
                            ctx.fill();
                        }
                    }
                });
                return; // Exit early if THREE.js isn't available
            }
            
            try {
                // Bronze Torus in Hero Section
                const bronzeTorusCanvas = document.getElementById('bronzeTorusCanvas');
                if (!bronzeTorusCanvas) throw new Error('Bronze torus canvas not found');
                
                const bronzeTorusScene = new THREE.Scene();
                const bronzeTorusCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const bronzeTorusRenderer = new THREE.WebGLRenderer({ 
                    canvas: bronzeTorusCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const bronzeTorusGeometry = new THREE.TorusGeometry(1, 0.4, 16, 100);
                const bronzeTorusMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0x65CCF3,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.8
                });
                const bronzeTorus = new THREE.Mesh(bronzeTorusGeometry, bronzeTorusMaterial);
                bronzeTorusScene.add(bronzeTorus);
                
                bronzeTorusCamera.position.z = 3;
                
                // Material Cube in Hero Section
                const materialCubeCanvas = document.getElementById('materialCubeCanvas');
                if (!materialCubeCanvas) throw new Error('Material cube canvas not found');
                
                const materialCubeScene = new THREE.Scene();
                const materialCubeCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const materialCubeRenderer = new THREE.WebGLRenderer({ 
                    canvas: materialCubeCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const materialCubeGeometry = new THREE.BoxGeometry(1, 1, 1);
                const materialCubeMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0xE12726,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.6
                });
                const materialCube = new THREE.Mesh(materialCubeGeometry, materialCubeMaterial);
                materialCubeScene.add(materialCube);
                
                materialCubeCamera.position.z = 3;
                
                // Material Pyramid in Hero Section
                const materialPyramidCanvas = document.getElementById('materialPyramidCanvas');
                if (!materialPyramidCanvas) throw new Error('Material pyramid canvas not found');
                
                const materialPyramidScene = new THREE.Scene();
                const materialPyramidCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const materialPyramidRenderer = new THREE.WebGLRenderer({ 
                    canvas: materialPyramidCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const materialPyramidGeometry = new THREE.ConeGeometry(0.8, 1.5, 4);
                const materialPyramidMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0xE12726,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.6
                });
                const materialPyramid = new THREE.Mesh(materialPyramidGeometry, materialPyramidMaterial);
                materialPyramid.rotation.y = Math.PI / 4;
                materialPyramidScene.add(materialPyramid);
                
                materialPyramidCamera.position.z = 3;
                
                // Metal Canvas in Services
                const metalCanvas = document.getElementById('metalCanvas');
                if (!metalCanvas) throw new Error('Metal canvas not found');
                
                const metalScene = new THREE.Scene();
                const metalCamera = new THREE.PerspectiveCamera(75, 2, 0.1, 1000);
                const metalRenderer = new THREE.WebGLRenderer({ 
                    canvas: metalCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const metalPointsGeometry = new THREE.BufferGeometry();
                const metalVertices = [];
                for (let i = 0; i < 1000; i++) {
                    metalVertices.push(
                        Math.random() * 2 - 1,
                        Math.random() * 2 - 1,
                        Math.random() * 2 - 1
                    );
                }
                metalPointsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(metalVertices, 3));
                const metalPointsMaterial = new THREE.PointsMaterial({
                    color: 0x65CCF3,
                    size: 0.02,
                    transparent: true,
                    opacity: 0.8
                });
                const metalPoints = new THREE.Points(metalPointsGeometry, metalPointsMaterial);
                metalScene.add(metalPoints);
                
                metalCamera.position.z = 2;
                if (metalCanvas.width && metalCanvas.height) {
                    metalRenderer.setSize(metalCanvas.width, metalCanvas.height);
                }
                
                // Uber Project Canvas
                const uberCanvas = document.getElementById('uberCanvas');
                if (!uberCanvas) throw new Error('Uber canvas not found');
                
                const uberScene = new THREE.Scene();
                const uberCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const uberRenderer = new THREE.WebGLRenderer({ 
                    canvas: uberCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                // Create a parametric wall for Uber project
                const uberGeometry = new THREE.BufferGeometry();
                const uberVertices = [];
                const gridSize = 10;
                
                for (let i = 0; i < gridSize; i++) {
                    for (let j = 0; j < gridSize; j++) {
                        uberVertices.push(
                            (i - gridSize/2) * 0.1,
                            (j - gridSize/2) * 0.1,
                            Math.sin(i * j * 0.1) * 0.05
                        );
                    }
                }
                
                uberGeometry.setAttribute('position', new THREE.Float32BufferAttribute(uberVertices, 3));
                const uberMaterial = new THREE.PointsMaterial({
                    color: 0x65CCF3,
                    size: 0.05,
                    sizeAttenuation: true
                });
                const uberPoints = new THREE.Points(uberGeometry, uberMaterial);
                uberScene.add(uberPoints);
                
                uberCamera.position.z = 2;
                if (uberCanvas.width && uberCanvas.height) {
                    uberRenderer.setSize(uberCanvas.width, uberCanvas.height);
                }
                
                // St. Nicholas Project Canvas
                const stNicholasCanvas = document.getElementById('stNicholasCanvas');
                if (!stNicholasCanvas) throw new Error('St. Nicholas canvas not found');
                
                const stNicholasScene = new THREE.Scene();
                const stNicholasCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const stNicholasRenderer = new THREE.WebGLRenderer({ 
                    canvas: stNicholasCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                // Create glass crosses for St. Nicholas
                const crossGroup = new THREE.Group();
                
                for (let i = 0; i < 10; i++) {
                    const verticalGeometry = new THREE.BoxGeometry(0.05, 0.3, 0.05);
                    const horizontalGeometry = new THREE.BoxGeometry(0.2, 0.05, 0.05);
                    const glassMaterial = new THREE.MeshBasicMaterial({
                        color: 0xE12726,
                        transparent: true,
                        opacity: 0.3
                    });
                    
                    const verticalPart = new THREE.Mesh(verticalGeometry, glassMaterial);
                    const horizontalPart = new THREE.Mesh(horizontalGeometry, glassMaterial);
                    horizontalPart.position.y = 0.05;
                    
                    const cross = new THREE.Group();
                    cross.add(verticalPart);
                    cross.add(horizontalPart);
                    
                    cross.position.x = (Math.random() - 0.5) * 1.5;
                    cross.position.y = (Math.random() - 0.5) * 1.5;
                    cross.position.z = (Math.random() - 0.5) * 1.5;
                    cross.rotation.x = Math.random() * Math.PI;
                    cross.rotation.y = Math.random() * Math.PI;
                    
                    crossGroup.add(cross);
                }
                
                stNicholasScene.add(crossGroup);
                stNicholasCamera.position.z = 3;
                if (stNicholasCanvas.width && stNicholasCanvas.height) {
                    stNicholasRenderer.setSize(stNicholasCanvas.width, stNicholasCanvas.height);
                }
                
                // Knoll Canvas
                const knollCanvas = document.getElementById('knollCanvas');
                if (!knollCanvas) throw new Error('Knoll canvas not found');
                
                const knollScene = new THREE.Scene();
                const knollCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const knollRenderer = new THREE.WebGLRenderer({ 
                    canvas: knollCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                // Create a bronze table for Knoll project
                const tableGroup = new THREE.Group();
                
                // Table top
                const tableTopGeometry = new THREE.BoxGeometry(1.5, 0.05, 0.8);
                const bronzeMaterial = new THREE.MeshBasicMaterial({
                    color: 0x65CCF3,
                    wireframe: false
                });
                const tableTop = new THREE.Mesh(tableTopGeometry, bronzeMaterial);
                tableTop.position.y = 0.4;
                tableGroup.add(tableTop);
                
                // Table legs
                for (let i = 0; i < 4; i++) {
                    const legGeometry = new THREE.CylinderGeometry(0.03, 0.03, 0.8, 8);
                    const leg = new THREE.Mesh(legGeometry, bronzeMaterial);
                    
                    const xPos = i < 2 ? -0.6 : 0.6;
                    const zPos = i % 2 === 0 ? -0.3 : 0.3;
                    
                    leg.position.set(xPos, 0, zPos);
                    tableGroup.add(leg);
                }
                
                knollScene.add(tableGroup);
                
                // Add some vertical metal rods behind (marquee)
                const rodsGroup = new THREE.Group();
                for (let i = 0; i < 15; i++) {
                    const rodGeometry = new THREE.CylinderGeometry(0.01, 0.01, 2, 8);
                    const rodMaterial = new THREE.MeshBasicMaterial({
                        color: 0xe8c496,
                        wireframe: false
                    });
                    const rod = new THREE.Mesh(rodGeometry, rodMaterial);
                    
                    rod.position.z = -0.5;
                    rod.position.x = (i - 7) * 0.1;
                    rod.position.y = 0.5;
                    
                    rodsGroup.add(rod);
                }
                
                knollScene.add(rodsGroup);
                
                // Knoll letters - simplified
                const lettersGroup = new THREE.Group();
                lettersGroup.position.z = -0.45;
                lettersGroup.position.y = 0.5;
                
                // Simple K
                const kGeometry = new THREE.BoxGeometry(0.03, 0.2, 0.01);
                const kMaterial = new THREE.MeshBasicMaterial({
                    color: 0x8b5a2b
                });
                const kVertical = new THREE.Mesh(kGeometry, kMaterial);
                kVertical.position.x = -0.3;
                
                lettersGroup.add(kVertical);
                
                knollScene.add(lettersGroup);
                
                knollCamera.position.z = 3;
                if (knollCanvas.width && knollCanvas.height) {
                    knollRenderer.setSize(knollCanvas.width, knollCanvas.height);
                }
                
                // Material Viz Canvas
                const materialVizCanvas = document.getElementById('materialVizCanvas');
                if (!materialVizCanvas) throw new Error('Material viz canvas not found');
                
                const materialVizScene = new THREE.Scene();
                const materialVizCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const materialVizRenderer = new THREE.WebGLRenderer({ 
                    canvas: materialVizCanvas, 
                    alpha: true,
                    antialias: true 
                });
                if (materialVizCanvas.width && materialVizCanvas.height) {
                    materialVizRenderer.setSize(materialVizCanvas.width, materialVizCanvas.height);
                }
                
                // Create a material preview system
                const materialVizParticles = 500;
                const materialVizPositions = new Float32Array(materialVizParticles * 3);
                const materialVizColors = new Float32Array(materialVizParticles * 3);
                
                for (let i = 0; i < materialVizParticles; i++) {
                    materialVizPositions[i * 3] = (Math.random() - 0.5) * 10;
                    materialVizPositions[i * 3 + 1] = (Math.random() - 0.5) * 10;
                    materialVizPositions[i * 3 + 2] = (Math.random() - 0.5) * 10;
                    
                    // Bronze-gold color palette
                    materialVizColors[i * 3] = 0.8; // R
                    materialVizColors[i * 3 + 1] = 0.6 + Math.random() * 0.2; // G
                    materialVizColors[i * 3 + 2] = 0.3 + Math.random() * 0.1; // B
                }
                
                const materialVizGeometry = new THREE.BufferGeometry();
                materialVizGeometry.setAttribute('position', new THREE.BufferAttribute(materialVizPositions, 3));
                materialVizGeometry.setAttribute('color', new THREE.BufferAttribute(materialVizColors, 3));
                
                const materialVizMaterial = new THREE.PointsMaterial({
                    size: 0.1,
                    vertexColors: true,
                    transparent: true,
                    opacity: 0.8,
                    sizeAttenuation: true
                });
                
                const materialVizParticleSystem = new THREE.Points(materialVizGeometry, materialVizMaterial);
                materialVizScene.add(materialVizParticleSystem);
                
                materialVizCamera.position.z = 5;
                
                // Studio Canvas
                const studioCanvas = document.getElementById('studioCanvas');
                if (!studioCanvas) throw new Error('Studio canvas not found');
                
                const studioScene = new THREE.Scene();
                const studioCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const studioRenderer = new THREE.WebGLRenderer({ 
                    canvas: studioCanvas, 
                    alpha: true,
                    antialias: true 
                });
                if (studioCanvas.width && studioCanvas.height) {
                    studioRenderer.setSize(studioCanvas.width, studioCanvas.height);
                }
                
                // Create a studio visualization with tools and materials
                const studioGroup = new THREE.Group();
                
                // Create some workshop tools - simplified anvil
                const anvilBaseGeometry = new THREE.BoxGeometry(0.5, 0.2, 0.3);
                const anvilTopGeometry = new THREE.BoxGeometry(0.7, 0.1, 0.25);
                const metalMaterial = new THREE.MeshBasicMaterial({ color: 0x777777 });
                
                const anvilBase = new THREE.Mesh(anvilBaseGeometry, metalMaterial);
                const anvilTop = new THREE.Mesh(anvilTopGeometry, metalMaterial);
                anvilTop.position.y = 0.15;
                
                const anvil = new THREE.Group();
                anvil.add(anvilBase);
                anvil.add(anvilTop);
                anvil.position.x = -0.5;
                anvil.position.y = -0.2;
                
                studioGroup.add(anvil);
                
                // Bronze bars
                for (let i = 0; i < 3; i++) {
                    const barGeometry = new THREE.BoxGeometry(0.1, 0.8, 0.1);
                    const bronzeMaterial = new THREE.MeshBasicMaterial({ color: 0xc99d66 });
                    const bar = new THREE.Mesh(barGeometry, bronzeMaterial);
                    bar.position.x = 0.5;
                    bar.position.y = -0.2 + i * 0.2;
                    bar.rotation.z = Math.PI * 0.1;
                    studioGroup.add(bar);
                }
                
                // Add some tools
                const hammerGeometry = new THREE.CylinderGeometry(0.05, 0.05, 0.3, 8);
                const hammerHeadGeometry = new THREE.BoxGeometry(0.15, 0.1, 0.08);
                const woodMaterial = new THREE.MeshBasicMaterial({ color: 0x8b4513 });
                
                const hammerHandle = new THREE.Mesh(hammerGeometry, woodMaterial);
                const hammerHead = new THREE.Mesh(hammerHeadGeometry, metalMaterial);
                
                hammerHandle.rotation.z = Math.PI * 0.25;
                hammerHead.rotation.z = Math.PI * 0.25;
                
                hammerHandle.position.x = 0;
                hammerHandle.position.y = 0.2;
                
                hammerHead.position.x = 0.1;
                hammerHead.position.y = 0.35;
                
                studioGroup.add(hammerHandle);
                studioGroup.add(hammerHead);
                
                studioScene.add(studioGroup);
                
                studioCamera.position.z = 3;
                studioCamera.position.y = 0.3;
                
                // Contact Canvas
                const contactCanvas = document.getElementById('contactCanvas');
                if (!contactCanvas) throw new Error('Contact canvas not found');
                
                const contactScene = new THREE.Scene();
                const contactCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const contactRenderer = new THREE.WebGLRenderer({ 
                    canvas: contactCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                // Create workshop environment with material samples
                const materialSamples = [];
                const materialPositions = [];
                const materialColors = [0xc99d66, 0xe8c496, 0xc28a4d, 0x8b5a2b, 0xd4af37];
                
                for (let i = 0; i < 5; i++) {
                    const sampleGeometry = new THREE.BoxGeometry(0.5, 0.1, 0.5);
                    const sampleMaterial = new THREE.MeshBasicMaterial({
                        color: materialColors[i],
                        transparent: i > 2,
                        opacity: i > 2 ? 0.7 : 1
                    });
                    const sample = new THREE.Mesh(sampleGeometry, sampleMaterial);
                    
                    sample.position.x = (Math.random() - 0.5) * 3;
                    sample.position.y = (Math.random() - 0.5) * 2;
                    sample.position.z = (Math.random() - 0.5) * 3;
                    sample.rotation.x = Math.random() * Math.PI;
                    sample.rotation.z = Math.random() * Math.PI;
                    
                    materialPositions.push(new THREE.Vector3(
                        sample.position.x,
                        sample.position.y,
                        sample.position.z
                    ));
                    
                    materialSamples.push(sample);
                    contactScene.add(sample);
                }
                
                // Add connecting lines
                const lineGeometry = new THREE.BufferGeometry();
                const lineVertices = [];
                
                for (let i = 0; i < materialPositions.length; i++) {
                    for (let j = i + 1; j < materialPositions.length; j++) {
                        lineVertices.push(
                            materialPositions[i].x, materialPositions[i].y, materialPositions[i].z,
                            materialPositions[j].x, materialPositions[j].y, materialPositions[j].z
                        );
                    }
                }
                
                lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute(lineVertices, 3));
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: 0xc99d66,
                    transparent: true,
                    opacity: 0.3
                });
                const lines = new THREE.LineSegments(lineGeometry, lineMaterial);
                contactScene.add(lines);
                
                contactCamera.position.z = 6;
                if (contactCanvas.width && contactCanvas.height) {
                    contactRenderer.setSize(contactCanvas.width, contactCanvas.height);
                }
                
                // Footer Material
                const footerMaterialCanvas = document.getElementById('footerMaterialCanvas');
                if (!footerMaterialCanvas) throw new Error('Footer material canvas not found');
                
                const footerMaterialScene = new THREE.Scene();
                const footerMaterialCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
                const footerMaterialRenderer = new THREE.WebGLRenderer({ 
                    canvas: footerMaterialCanvas, 
                    alpha: true,
                    antialias: true 
                });
                
                const footerMaterialGeometry = new THREE.SphereGeometry(1, 32, 32);
                const footerMaterialMaterial = new THREE.MeshBasicMaterial({
                    color: 0xc99d66,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.4
                });
                const footerMaterial = new THREE.Mesh(footerMaterialGeometry, footerMaterialMaterial);
                footerMaterialScene.add(footerMaterial);
                
                footerMaterialCamera.position.z = 3;
                
                // Intersection Observer for animated elements
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                        }
                    });
                }, {
                    threshold: 0.1
                });
                
                document.querySelectorAll('.feature-panel').forEach(panel => {
                    observer.observe(panel);
                });
                
                // Animation loop
                function animate() {
                    requestAnimationFrame(animate);
                    
                    try {
                        // Rotate bronze torus
                        if (bronzeTorus && bronzeTorusRenderer && bronzeTorusScene && bronzeTorusCamera) {
                            bronzeTorus.rotation.x += 0.01;
                            bronzeTorus.rotation.y += 0.01;
                            bronzeTorusRenderer.render(bronzeTorusScene, bronzeTorusCamera);
                        }
                        
                        // Rotate material cube (slower)
                        if (materialCube && materialCubeRenderer && materialCubeScene && materialCubeCamera) {
                            materialCube.rotation.x += 0.005;
                            materialCube.rotation.y += 0.005;
                            materialCubeRenderer.render(materialCubeScene, materialCubeCamera);
                        }
                        
                        // Rotate material pyramid (different axis)
                        if (materialPyramid && materialPyramidRenderer && materialPyramidScene && materialPyramidCamera) {
                            materialPyramid.rotation.x += 0.007;
                            materialPyramid.rotation.z += 0.007;
                            materialPyramidRenderer.render(materialPyramidScene, materialPyramidCamera);
                        }
                        
                        // Animate metal points
                        if (metalPoints && metalRenderer && metalScene && metalCamera) {
                            metalPoints.rotation.y += 0.005;
                            metalRenderer.render(metalScene, metalCamera);
                        }
                        
                        // Animate Uber points
                        if (uberPoints && uberRenderer && uberScene && uberCamera) {
                            uberPoints.rotation.y += 0.01;
                            const uberPositions = uberPoints.geometry.attributes.position;
                            for (let i = 2; i < uberPositions.count * 3; i += 3) {
                                uberPositions.array[i] = Math.sin(Date.now() * 0.001 + i) * 0.1;
                            }
                            uberPositions.needsUpdate = true;
                            uberRenderer.render(uberScene, uberCamera);
                        }
                        
                        // Animate St. Nicholas crosses
                        if (crossGroup && stNicholasRenderer && stNicholasScene && stNicholasCamera) {
                            crossGroup.rotation.y += 0.005;
                            stNicholasRenderer.render(stNicholasScene, stNicholasCamera);
                        }
                        
                        // Animate Knoll project
                        if (tableGroup && rodsGroup && knollRenderer && knollScene && knollCamera) {
                            tableGroup.rotation.y += 0.005;
                            rodsGroup.rotation.y += 0.003;
                            knollRenderer.render(knollScene, knollCamera);
                        }
                        
                        // Animate material viz particles
                        if (materialVizParticleSystem && materialVizRenderer && materialVizScene && materialVizCamera) {
                            materialVizParticleSystem.rotation.y += 0.003;
                            materialVizRenderer.render(materialVizScene, materialVizCamera);
                        }
                        
                        // Animate studio elements
                        if (studioGroup && studioRenderer && studioScene && studioCamera) {
                            studioGroup.rotation.y += 0.005;
                            studioRenderer.render(studioScene, studioCamera);
                        }
                        
                        // Animate contact samples
                        if (materialSamples.length && contactRenderer && contactScene && contactCamera) {
                            materialSamples.forEach((sample, i) => {
                                sample.position.y = Math.sin(Date.now() * 0.001 + i) * 0.2;
                                sample.rotation.x += 0.01;
                            });
                            contactRenderer.render(contactScene, contactCamera);
                        }
                        
                        // Rotate footer material
                        if (footerMaterial && footerMaterialRenderer && footerMaterialScene && footerMaterialCamera) {
                            footerMaterial.rotation.y += 0.01;
                            footerMaterialRenderer.render(footerMaterialScene, footerMaterialCamera);
                        }
                    } catch (error) {
                        console.log('Error in animation loop:', error);
                    }
                }
                
                animate();
                
                // Handle window resize
                window.addEventListener('resize', function() {
                    try {
                        // Adjust canvas sizes and camera aspects
                        const canvases = [
                            { canvas: bronzeTorusCanvas, renderer: bronzeTorusRenderer, camera: bronzeTorusCamera },
                            { canvas: materialCubeCanvas, renderer: materialCubeRenderer, camera: materialCubeCamera },
                            { canvas: materialPyramidCanvas, renderer: materialPyramidRenderer, camera: materialPyramidCamera },
                            { canvas: metalCanvas, renderer: metalRenderer, camera: metalCamera },
                            { canvas: uberCanvas, renderer: uberRenderer, camera: uberCamera },
                            { canvas: stNicholasCanvas, renderer: stNicholasRenderer, camera: stNicholasCamera },
                            { canvas: knollCanvas, renderer: knollRenderer, camera: knollCamera },
                            { canvas: materialVizCanvas, renderer: materialVizRenderer, camera: materialVizCamera },
                            { canvas: studioCanvas, renderer: studioRenderer, camera: studioCamera },
                            { canvas: contactCanvas, renderer: contactRenderer, camera: contactCamera },
                            { canvas: footerMaterialCanvas, renderer: footerMaterialRenderer, camera: footerMaterialCamera }
                        ];
                        
                        for (var i = 0; i < canvases.length; i++) {
                            var item = canvases[i];
                            if (!item.canvas || !item.renderer || !item.camera) continue;
                            
                            var parent = item.canvas.parentElement;
                            if (!parent) continue;
                            
                            var width = parent.offsetWidth;
                            var height = parent.offsetHeight;
                            
                            if (width > 0 && height > 0) {
                                item.canvas.width = width;
                                item.canvas.height = height;
                                item.renderer.setSize(width, height);
                                
                                // Update camera for new aspect ratio
                                item.camera.aspect = width / height;
                                item.camera.updateProjectionMatrix();
                            }
                        }
                    } catch (error) {
                        console.log('Error in resize handler:', error);
                    }
                });
                
                // Mobile optimization for 3D rendering
                const isMobile = window.innerWidth < 768;
                
                // Reduce complexity for mobile devices
                if (isMobile) {
                    // Reduce particle count for better performance
                    const particleReduction = 0.5; // 50% reduction
                    
                    if (metalPointsGeometry && metalVertices) {
                        const reducedMetalVertices = [];
                        for (let i = 0; i < metalVertices.length * particleReduction; i += 3) {
                            reducedMetalVertices.push(
                                metalVertices[i],
                                metalVertices[i + 1],
                                metalVertices[i + 2]
                            );
                        }
                        metalPointsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(reducedMetalVertices, 3));
                    }
                    
                    // Reduce animation frame rate on mobile
                    const mobileFrameRate = 30; // fps
                    const frameInterval = 1000 / mobileFrameRate;
                    let lastFrameTime = 0;
                    
                    // Override the animation loop for mobile
                    function mobileAnimate(currentTime) {
                        requestAnimationFrame(mobileAnimate);
                        
                        // Throttle frame rate on mobile
                        if (currentTime - lastFrameTime < frameInterval) return;
                        lastFrameTime = currentTime;
                        
                        try {
                            // Mobile-optimized animations
                            if (bronzeTorus && bronzeTorusRenderer && bronzeTorusScene && bronzeTorusCamera) {
                                bronzeTorus.rotation.x += 0.005; // Reduced speed
                                bronzeTorus.rotation.y += 0.005;
                                bronzeTorusRenderer.render(bronzeTorusScene, bronzeTorusCamera);
                            }
                            
                            // Only render visible elements on mobile
                            const visibleSections = [];
                            document.querySelectorAll('section').forEach(section => {
                                const rect = section.getBoundingClientRect();
                                if (rect.top < window.innerHeight && rect.bottom > 0) {
                                    visibleSections.push(section.id || 'hero');
                                }
                            });
                            
                            // Only render what's visible
                            if (visibleSections.includes('hero') || visibleSections.length === 0) {
                                if (bronzeTorus && bronzeTorusRenderer && bronzeTorusScene && bronzeTorusCamera) {
                                    bronzeTorusRenderer.render(bronzeTorusScene, bronzeTorusCamera);
                                }
                            }
                            
                            if (visibleSections.includes('services')) {
                                if (metalPoints && metalRenderer && metalScene && metalCamera) {
                                    metalRenderer.render(metalScene, metalCamera);
                                }
                            }
                            
                            if (visibleSections.includes('projects')) {
                                if (uberPoints && uberRenderer && uberScene && uberCamera) {
                                    uberRenderer.render(uberScene, uberCamera);
                                }
                                if (crossGroup && stNicholasRenderer && stNicholasScene && stNicholasCamera) {
                                    stNicholasRenderer.render(stNicholasScene, stNicholasCamera);
                                }
                                if (tableGroup && knollRenderer && knollScene && knollCamera) {
                                    knollRenderer.render(knollScene, knollCamera);
                                }
                            }
                        } catch (error) {
                            console.log('Error in mobile animation loop:', error);
                        }
                    }
                    
                    // Use mobile-optimized animation loop
                    mobileAnimate(0);
                    return; // Skip the standard animation loop
                }
                
            } catch (error) {
                console.log('Error initializing 3D elements:', error);
                // Create fallback backgrounds for all canvas elements on error
                document.querySelectorAll('canvas').forEach(canvas => {
                    const ctx = canvas.getContext('2d');
                    if (ctx) {
                        // Create gradient background
                        const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                        gradient.addColorStop(0, '#1a1a24');
                        gradient.addColorStop(1, '#101014');
                        ctx.fillStyle = gradient;
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        
                        // Add some subtle texture/pattern
                        ctx.fillStyle = 'rgba(201, 157, 102, 0.1)';
                        for (let i = 0; i < 20; i++) {
                            const x = Math.random() * canvas.width;
                            const y = Math.random() * canvas.height;
                            const size = Math.random() * 10 + 2;
                            ctx.beginPath();
                            ctx.arc(x, y, size, 0, Math.PI * 2);
                            ctx.fill();
                        }
                    }
                });
            }
        });
    </script>
            
            // Trigger initial resize
            window.dispatchEvent(new Event('resize'));
        });
    </script>
</body>
</html>
